<!DOCTYPE html>





























































































<html>
<head>


<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta content="IE=edge" http-equiv="X-UA-Compatible">

<meta name="Description" content="Dev Byte: What&#39;s New in Android 5.0 Dev Byte: Notifications API Level: Ringtone, MediaPlayer, or Vibrator classes, remove this code so that the system can present notifications correctly in priority mode. Instead, use Builder methods to add sounds…">
<link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico" />
<title>Android 5.0 Behavior Changes | Android Developers</title>

<!-- STYLESHEETS -->
<link rel="stylesheet"
href="http://fonts.useso.com/css?family=Roboto+Condensed">
<link rel="stylesheet" href="http://fonts.useso.com/css?family=Roboto:light,regular,medium,thin,italic,mediumitalic,bold"
  title="roboto">

<link href="../../assets/css/default.css?v=7" rel="stylesheet" type="text/css">



<!-- JAVASCRIPT -->
<script src="../../assets/js/android_3p-bundle.js" type="text/javascript"></script>
<script type="text/javascript">
  var toRoot = "../../";
  var metaTags = [];
  var devsite = false;
</script>
<script src="../../assets/js/docs.js?v=6" type="text/javascript"></script>



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-5831155-1', 'android.com');
  ga('create', 'UA-49880327-2', 'android.com', {'name': 'universal'});  // New tracker);
  ga('send', 'pageview');
  ga('universal.send', 'pageview'); // Send page view for new tracker.
</script>

</head>

<body class="gc-documentation


about" itemscope itemtype="http://schema.org/Article">
<a name="top"></a>

<!-- dialog to prompt lang pref change when loaded from hardcoded URL
<div id="langMessage" style="display:none">
  <div>
    <div class="lang en">
      <p>You requested a page in English, would you like to proceed with this language setting?</p>
    </div>
    <div class="lang es">
      <p>You requested a page in Spanish (Español), would you like to proceed with this language setting?</p>
    </div>
    <div class="lang ja">
      <p>You requested a page in Japanese (日本語), would you like to proceed with this language setting?</p>
    </div>
    <div class="lang ko">
      <p>You requested a page in Korean (한국어), would you like to proceed with this language setting?</p>
    </div>
    <div class="lang ru">
      <p>You requested a page in Russian (Русский), would you like to proceed with this language setting?</p>
    </div>
    <div class="lang zh-cn">
      <p>You requested a page in Simplified Chinese (简体中文), would you like to proceed with this language setting?</p>
    </div>
    <div class="lang zh-tw">
      <p>You requested a page in Traditional Chinese (繁體中文), would you like to proceed with this language setting?</p>
    </div>
    <a href="#" class="button yes" onclick="return false;">
      <span class="lang en">Yes</span>
      <span class="lang es">Sí</span>
      <span class="lang ja">Yes</span>
      <span class="lang ko">Yes</span>
      <span class="lang ru">Yes</span>
      <span class="lang zh-cn">是的</span>
      <span class="lang zh-tw">没有</span>
    </a>
    <a href="#" class="button" onclick="$('#langMessage').hide();return false;">
      <span class="lang en">No</span>
      <span class="lang es">No</span>
      <span class="lang ja">No</span>
      <span class="lang ko">No</span>
      <span class="lang ru">No</span>
      <span class="lang zh-cn">没有</span>
      <span class="lang zh-tw">没有</span>
    </a>
  </div>
</div> -->


  <!-- Header -->
  <div id="header-wrapper">
    <div class="dac-header" id="header">




      <div class="dac-header-inner">
        <a class="dac-nav-toggle" data-dac-toggle-nav href="javascript:;" title="Open navigation">
          <span class="dac-nav-hamburger">
            <span class="dac-nav-hamburger-top"></span>
            <span class="dac-nav-hamburger-mid"></span>
            <span class="dac-nav-hamburger-bot"></span>
          </span>
        </a>
        <a class="dac-header-logo" href="../../index.html">
          <img class="dac-header-logo-image" src="../../assets/images/android_logo.png"
              srcset="../../assets/images/android_logo@2x.png 2x"
              width="32" height="36" alt="Android" /> Developers
          </a>

        <ul class="dac-header-crumbs">
          
          <li class="dac-header-crumbs-item"><span class="dac-header-crumbs-link current ">Android 5.0 Behavior Changes</a></li>
        </ul>

        
        
        
  <div class="dac-header-search" id="search-container">
    <div class="dac-header-search-inner">
      <div class="dac-sprite dac-search dac-header-search-btn" id="search-btn"></div>
      <form class="dac-header-search-form" onsubmit="return submit_search()">
        <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q"
          onfocus="search_focus_changed(this, true)" onblur="search_focus_changed(this, false)"
          onkeydown="return search_changed(event, true, '../../')"
          onkeyup="return search_changed(event, false, '../../')"
          class="dac-header-search-input" placeholder="Search" />
          <a class="dac-header-search-close hide" id="search-close">close</a>
      </form>
    </div><!-- end dac-header-search-inner -->
  </div><!-- end dac-header-search -->

  <div class="search_filtered_wrapper">
    <div class="suggest-card reference no-display">
      <ul class="search_filtered">
      </ul>
    </div>
    <div class="suggest-card develop no-display">
      <ul class="search_filtered">
      </ul>
      <div class="child-card guides no-display">
      </div>
      <div class="child-card training no-display">
      </div>
      <div class="child-card samples no-display">
      </div>
    </div>
    <div class="suggest-card design no-display">
      <ul class="search_filtered">
      </ul>
    </div>
    <div class="suggest-card distribute no-display">
      <ul class="search_filtered">
      </ul>
    </div>
  </div>

        

        <a class="dac-header-console-btn" href="https://play.google.com/apps/publish/">
          <span class="dac-sprite dac-google-play"></span>
          <span class="dac-visible-desktop-inline">Developer</span>
          Console
        </a>

      </div><!-- end header-wrap.wrap -->
    </div><!-- end header -->

    <div id="searchResults" class="wrap" style="display:none;">
      <h2 id="searchTitle">Results</h2>
      <div id="leftSearchControl" class="search-control">Loading...</div>
    </div>
  </div> <!--end header-wrapper -->

  
  <!-- Navigation-->
  <nav class="dac-nav">
    <div class="dac-nav-dimmer" data-dac-toggle-nav></div>

    <ul class="dac-nav-list" data-dac-nav>
      <li class="dac-nav-item dac-nav-head">
        <a class="dac-nav-link dac-nav-logo" data-dac-toggle-nav href="javascript:;" title="Close navigation">
          <img class="dac-logo-image" src="../../assets/images/android_logo.png"
               srcset="../../assets/images/android_logo@2x.png 2x"
               width="32" height="36" alt="Android" /> Developers
        </a>
      </li>
      <li class="dac-nav-item home">
        <a class="dac-nav-link dac-visible-mobile-block" href="../../index.html">Home</a>
        <ul class="dac-nav-secondary about">
          <li class="dac-nav-item about">
            <a class="dac-nav-link" href="../../about/index.html">Android</a>
          </li>
          <li class="dac-nav-item wear">
            <a class="dac-nav-link" href="../../wear/index.html">Wear</a>
          </li>
          <li class="dac-nav-item tv">
            <a class="dac-nav-link" href="../../tv/index.html">TV</a>
          </li>
          <li class="dac-nav-item auto">
            <a class="dac-nav-link" href="../../auto/index.html">Auto</a>
          </li>
        </ul>
      </li>
      <li class="dac-nav-item design">
        <a class="dac-nav-link" href="../../design/index.html"
           zh-tw-lang="設計"
           zh-cn-lang="设计"
           ru-lang="Проектирование"
           ko-lang="디자인"
           ja-lang="設計"
           es-lang="Diseñar">Design</a>
      </li>
      <li class="dac-nav-item develop">
        <a class="dac-nav-link" href="../../develop/index.html"
           zh-tw-lang="開發"
           zh-cn-lang="开发"
           ru-lang="Разработка"
           ko-lang="개발"
           ja-lang="開発"
           es-lang="Desarrollar">Develop</a>
        <ul class="dac-nav-secondary develop">
          <li class="dac-nav-item training">
            <a class="dac-nav-link" href="../../training/index.html"
               zh-tw-lang="訓練課程"
               zh-cn-lang="培训"
               ru-lang="Курсы"
               ko-lang="교육"
               ja-lang="トレーニング"
               es-lang="Capacitación">Training</a>
          </li>
          <li class="dac-nav-item guide">
            <a class="dac-nav-link" href="../../guide/index.html"
               zh-tw-lang="API 指南"
               zh-cn-lang="API 指南"
               ru-lang="Руководства по API"
               ko-lang="API 가이드"
               ja-lang="API ガイド"
               es-lang="Guías de la API">API Guides</a>
          </li>
          <li class="dac-nav-item reference">
            <a class="dac-nav-link" href="../../reference/packages.html"
               zh-tw-lang="參考資源"
               zh-cn-lang="参考"
               ru-lang="Справочник"
               ko-lang="참조문서"
               ja-lang="リファレンス"
               es-lang="Referencia">Reference</a>
          </li>
          <li class="dac-nav-item tools">
            <a class="dac-nav-link" href="../../sdk/index.html"
               zh-tw-lang="相關工具"
               zh-cn-lang="工具"
               ru-lang="Инструменты"
               ko-lang="도구"
               ja-lang="ツール"
               es-lang="Herramientas">Tools</a></li>
          <li class="dac-nav-item google">
            <a class="dac-nav-link" href="../../google/index.html">Google Services</a>
          </li>
          
          <li class="dac-nav-item preview">
            <a class="dac-nav-link" href="../../preview/index.html">Preview</a>
          </li>
        </ul>
      </li>
      <li class="dac-nav-item distribute">
        <a class="dac-nav-link" href="../../distribute/googleplay/index.html"
           zh-tw-lang="發佈"
           zh-cn-lang="分发"
           ru-lang="Распространение"
           ko-lang="배포"
           ja-lang="配布"
           es-lang="Distribuir">Distribute</a>
        <ul class="dac-nav-secondary distribute">
          <li class="dac-nav-item googleplay">
            <a class="dac-nav-link" href="../../distribute/googleplay/index.html">Google Play</a></li>
          <li class="dac-nav-item essentials">
            <a class="dac-nav-link" href="../../distribute/essentials/index.html">Essentials</a></li>
          <li class="dac-nav-item users">
            <a class="dac-nav-link" href="../../distribute/users/index.html">Get Users</a></li>
          <li class="dac-nav-item engage">
            <a class="dac-nav-link" href="../../distribute/engage/index.html">Engage &amp; Retain</a></li>
          <li class="dac-nav-item monetize">
            <a class="dac-nav-link" href="../../distribute/monetize/index.html">Earn</a>
          </li>
          <li class="dac-nav-item analyze">
            <a class="dac-nav-link" href="../../distribute/analyze/index.html">Analyze</a>
          </li>
          <li class="dac-nav-item stories">
            <a class="dac-nav-link" href="../../distribute/stories/index.html">Stories</a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>
  <!-- end navigation-->
  




  <div class="wrap clearfix" id="body-content"><div class="cols">
    <div class="col-3 dac-toggle dac-mobile" id="side-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
      
  <div class="dac-visible-mobile-block" data-toggle="section">
    <span class="dac-toggle-expand dac-devdoc-toggle"><i class="dac-sprite dac-expand-more-black"></i> Show navigation</span>
    <span class="dac-toggle-collapse dac-devdoc-toggle" data-toggle-section><i class="dac-sprite dac-expand-less-black"></i> Hide navigation</span>
  </div>

      <div class="dac-toggle-content" id="devdoc-nav">
        <div class="scroll-pane">
<ul id="nav">

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../about/versions/lollipop.html"
              zh-tw-lang="Lollipop"
              zh-cn-lang="Lollipop"
              ru-lang="Lollipop"
              ko-lang="Lollipop"
              ja-lang="Lollipop"
              es-lang="Lollipop">
      <span class="en">Lollipop</span></a></div>
      <ul>
        <li><a href="../../about/versions/android-5.0.html"
              zh-tw-lang="Android 5.0 API"
              zh-cn-lang="Android 5.0 API"
              ru-lang="API для Android 5.0"
              ko-lang="Android 5.0 API"
              ja-lang="Android 5.0 API"
              es-lang="API de Android 5.0">
              Android 5.0 APIs</a></li>
        <li><a href="../../about/versions/android-5.0-changes.html">

        Android 5.0 Changes</a></li>
      </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header"><a href="../../about/versions/kitkat.html">
      <span class="en">KitKat</span></a></div>
      <ul>
        <li><a href="../../about/versions/android-4.4.html">Android 4.4 APIs</a></li>
      </ul>
  </li>
  <li class="nav-section">
    <div class="nav-section-header"><a href="../../about/versions/jelly-bean.html">
      <span class="en">Jelly Bean</span></a></div>
      <ul>
        <li><a href="../../about/versions/android-4.3.html">Android 4.3 APIs</a></li>
        <li><a href="../../about/versions/android-4.2.html">Android 4.2 APIs</a></li>
        <li><a href="../../about/versions/android-4.1.html">Android 4.1 APIs</a></li>
      </ul>
  </li>

  <!-- <li class="nav-section">
    <div class="nav-section-header"><a href="../../about/versions/android-4.0-highlights.html">
      <span class="en">Ice Cream Sandwich</span></a></div>
      <ul>
        <li><a href="../../about/versions/android-4.0.3.html">Android 4.0.3 APIs</a></li>
        <li><a href="../../about/versions/android-4.0.html">Android 4.0 APIs</a> </li>
      </ul>
  </li> -->

  <li class="nav-section">
    <div class="nav-section-header empty"><a href="../../about/android.html">About Android</a></div>
  </li>

  <li class="nav-section">
    <div class="nav-section-header empty"><a href="../../about/dashboards/index.html">Dashboards</a></div>
  </li>

</ul>
        </div>
      </div>
    </div> <!-- end side-nav -->
    <script>
      $(document).ready(function() {
        scrollIntoView("devdoc-nav");
        });
    </script>




<div class="col-13" id="doc-col" >


  

  
    
      
        <h1 itemprop="name" >Android 5.0 Behavior Changes</h1>
      
    
  


  
  <div id="jd-content">


    <div class="jd-descr" itemprop="articleBody">
    <!-- video box -->

<div id="qv-wrapper">
<div id="qv">

<h2>In this document</h2>

<ol id="toc44" class="hide-nested">
  <li><a href="#UI"><a href="#ART">ART Runtime</a></a></li>
  <li><a href="#BehaviorNotifications">Notifications</a></li>
  <li><a href="#BehaviorMediaControl">Media Controls</a></li>
  <li><a href="#BehaviorGetRecentTasks">getRecentTasks()</a></li>
  <li><a href="#64BitSupport">64-Bit Android NDK</a></li>
  <li><a href="#BindService">Binding to a Service</a></li>
  <li><a href="#Power"><a href="#BehaviorWebView">WebView</a></a></li>
  <li><a href="#custom_permissions">Custom Permissions</a></li>
  <li><a href="#ssl">TLS/SSL Configuration</a></li>
  <li><a href="#managed_profiles">Support for Managed Profiles</a></li>
</ol>

<h2>API Differences</h2>
<ol>
<li><a href="../../sdk/api_diff/21/changes.html">API level 20 to 21 &raquo;</a> </li>
<li><a href="../../sdk/api_diff/preview-21/changes.html">L Developer Preview to 21 &raquo;</a> </li>
</ol>


<h2>See Also</h2>
<ol>
<li><a href="../../about/versions/lollipop.html">Android Lollipop Highlights</a> </li>
<li><a href="../../about/versions/android-5.0.html">Android 5.0 API Overview</a> </li>
</ol>


</div>
</div>

<a class="notice-developers-video" href="https://www.youtube.com/watch?v=um1S2u022HA">
<div>
    <h3>Video</h3>
    <p>Dev Byte: What's New in Android 5.0</p>
</div>
</a>

<a class="notice-developers-video" href="https://www.youtube.com/watch?v=Uiq2kZ2JHVY">
<div>
    <h3>Video</h3>
    <p>Dev Byte: Notifications</p>
</div>
</a>

<p>API Level: 21</p>
<p>Along with new features and capabilities, Android 5.0 includes a variety of
system changes and API behavior changes. This document highlights
some of the key changes that you should be understand and account for in your apps.</p>

<p>If you have previously published an app for Android, be aware that your app
  might be affected by these changes in Android 5.0.</p>


<p>For a high-level look at the new platform features, instead
see the
<a href="../../about/versions/lollipop.html">Android Lollipop
highlights</a>.</p>



<h2 id="ART">Android Runtime (ART)</h2>

<p>In Android 5.0 the ART runtime replaces Dalvik as the platform default. The ART runtime was
introduced in Android 4.4 on an experimental basis.</p>

<p>For an overview of ART's new features, see
<a href="https://source.android.com/devices/tech/dalvik/art.html">Introducing
ART</a>. Some of the major new features are:</p>

<ul>
  <li>Ahead-of-time (AOT) compilation</li>
  <li>Improved garbage collection (GC)</li>
  <li>Improved debugging support</li>
</ul>

<p>Most Android apps should just work without any changes under ART. However, some
techniques that work on Dalvik do not work on ART. For information about the
most important issues, see
<a href="../../guide/practices/verifying-apps-art.html">Verifying App
Behavior on the Android Runtime (ART)</a>. Pay particular attention if:</p>

<ul>
  <li>Your app uses Java Native Interface (JNI) to run C/C++ code.</li>
  <li>You use development tools that generate non-standard code (such as some
      obfuscators).</li>
  <li>You use techniques that are incompatible with compacting garbage
      collection.</li>
</ul>


<h2 id="BehaviorNotifications">Notifications</h2>

<p>Make sure your notifications take these Android 5.0 changes into account.
 To learn more about designing your notifications for Android 5.0 and higher,
 see the <a href="../../design/patterns/notifications.html">notifications design guide</a>.
</p>

<h3 id="NotificationsMaterialDesignStyle">Material design style</h3>
<p>Notifications are drawn with dark text atop white (or very light) backgrounds
  to match the new material design widgets. Make sure that all your
  notifications look right with the new color scheme. If your notifications
look wrong, fix them:</p>

<ul>
  <li>Use <code><a href="../../reference/android/app/Notification.Builder.html#setColor(int)">setColor()</a></code>
    to set an accent color in a circle behind your icon image. </li>
  <li>Update or remove assets that involve color. The system ignores all
    non-alpha channels in action icons and in the main notification icon. You
    should assume that these icons will be alpha-only. The system draws
    notification icons in white and action icons in dark gray.</li>
</ul>

<h3 id="NotificationsSoundVibration">Sound and vibration</h3>
<p>If you are currently adding sounds and vibrations to your notifications by
using the <code><a href="../../reference/android/media/Ringtone.html">Ringtone</a></code>, <code><a href="../../reference/android/media/MediaPlayer.html">MediaPlayer</a></code>,
or <code><a href="../../reference/android/os/Vibrator.html">Vibrator</a></code> classes, remove this code so that
the system can present notifications correctly in
<em>priority</em> mode. Instead, use
<code><a href="../../reference/android/app/Notification.Builder.html">Notification.Builder</a></code> methods to add sounds and
vibration.</p>

<p>Setting the device to
<code><a href="../../reference/android/media/AudioManager.html#RINGER_MODE_SILENT">RINGER_MODE_SILENT</a></code> causes
the device to enter the new priority mode. The device leaves priority
mode if you set it to
<code><a href="../../reference/android/media/AudioManager.html#RINGER_MODE_NORMAL">RINGER_MODE_NORMAL</a></code> or
<code><a href="../../reference/android/media/AudioManager.html#RINGER_MODE_NORMAL">RINGER_MODE_VIBRATE</a></code>.</p>

<p>Previously, Android used <code><a href="../../reference/android/media/AudioManager.html#STREAM_MUSIC">STREAM_MUSIC</a></code>
as the master stream to control volume on tablet devices. In Android 5.0, the
master volume stream for both phone and tablet devices is now unified, and
is controlled by <code><a href="../../reference/android/media/AudioManager.html#STREAM_RING">STREAM_RING</a></code> or
<code><a href="../../reference/android/media/AudioManager.html#STREAM_NOTIFICATION">STREAM_NOTIFICATION</a></code>.</p>

<h3 id="NotificationsLockscreenVisibility">Lock screen visibility</h3>
<p>By default, notifications now appear on the user's lock screen in Android 5.0.
Users can choose to protect sensitive information from being exposed, in which
case the system automatically redacts the text displayed by the notification. To
customize this redacted notification, use
<code><a href="../../reference/android/app/Notification.Builder.html#setPublicVersion(android.app.Notification)">setPublicVersion()</a></code>.</p>
<p>If the notification does not contain personal information, or if you want to
allow media playback control on the notification, call the
<code><a href="../../reference/android/app/Notification.Builder.html#setVisibility(int)">setVisibility()</a></code>
method and set the notification's visibility level to
<code><a href="../../reference/android/app/Notification.html#VISIBILITY_PUBLIC">VISIBILITY_PUBLIC</a></code>.
</p>

<h3 id="NotificationsMediaPlayback">Media playback</h3>
<p>If you are implementing notifications that present media playback
status or transport controls, consider using the new
<code><a href="../../reference/android/app/Notification.MediaStyle.html">Notification.MediaStyle</a></code> template instead of a custom
<code><a href="../../reference/android/widget/RemoteViews.RemoteView.html">RemoteViews.RemoteView</a></code> object. Whichever approach you
choose, make sure to set the notification's visibility to
<code><a href="../../reference/android/app/Notification.html#VISIBILITY_PUBLIC">VISIBILITY_PUBLIC</a></code> so that
your controls are accessible from the lock screen. Note that beginning in
Android 5.0, the system no longer shows
<code><a href="../../reference/android/media/RemoteControlClient.html">RemoteControlClient</a></code> objects on the lock screen. For more
information, see
<a href="#BehaviorMediaControl">If your app uses RemoteControlClient</a>.</p>

<h3 id="NotificationsHeadsup">Heads-up notification</h3>
<p>Notifications may now appear in a small floating window (also called a
  heads-up notification) when the device is active (that is, the device is
  unlocked and its screen is on). These notifications appear similar to the
  compact form of your notification, except that the heads-up notification also
  shows action buttons. Users can act on, or dismiss, a heads-up notification
  without leaving the current app.</p>

<p>Examples of conditions that may trigger heads-up notifications include:</p>

<ul>
  <li>The user's activity is in fullscreen mode (the app uses
<code><a href="../../reference/android/app/Notification.html#fullScreenIntent">fullScreenIntent</a></code>)</li>
  <li>The notification has high priority and uses ringtones or vibrations</li>
</ul>

<p>If your app implements notifications under any of those scenarios, make sure
that heads-up notifications are presented correctly.</p>

<h2 id="BehaviorMediaControl">Media Controls and RemoteControlClient</h2>
<p>The <code><a href="../../reference/android/media/RemoteControlClient.html">RemoteControlClient</a></code> class is now deprecated. Switch
  to the new <code><a href="../../reference/android/media/session/MediaSession.html">MediaSession</a></code> API as
  soon as possible.</p>

<p>Lock screens in Android 5.0 do not show transport controls for
your <code><a href="../../reference/android/media/session/MediaSession.html">MediaSession</a></code> or
<code><a href="../../reference/android/media/RemoteControlClient.html">RemoteControlClient</a></code>. Instead, your app can provide
media playback control from the lock screen through a notification. This
gives your app more control over the presentation of media buttons, while
providing a consistent experience for users across locked and
unlocked devices.</p>

<p>Android 5.0 introduces a new
<code><a href="../../reference/android/app/Notification.MediaStyle.html">Notification.MediaStyle</a></code> template for this purpose.
<code><a href="../../reference/android/app/Notification.MediaStyle.html">Notification.MediaStyle</a></code> converts notification
actions that you added with
<code><a href="../../reference/android/app/Notification.Builder.html#addAction(int, java.lang.CharSequence, android.app.PendingIntent)">Notification.Builder.addAction()</a></code> into compact buttons embedded in your app's
media playback notifications. Pass your session token to the
<code><a href="../../reference/android/app/Notification.MediaStyle.html#setMediaSession(android.media.session.MediaSession.Token)">setSession()</a></code> method to inform the system that this notification controls an
  ongoing media session.</p>

<p>Make sure to set the notification's visibility to
  <code><a href="../../reference/android/app/Notification.html#VISIBILITY_PUBLIC">VISIBILITY_PUBLIC</a></code>
  to mark the notification as safe to show on any lock screen (secure or
  otherwise). For more information, see
  <a href="#LockscreenNotifications">Lock screen notifications</a>.</p>

<p>To display media playback controls if your app is running on the
Android <a href="../../tv/index.html">TV</a> or
<a href="../../wear/index.html">Wear</a> platform, implement the
<code><a href="../../reference/android/media/session/MediaSession.html">MediaSession</a></code> class. You should also implement
<code><a href="../../reference/android/media/session/MediaSession.html">MediaSession</a></code> if your app needs to receive media
button events on Android devices.</p>

<h2 id="BehaviorGetRecentTasks">getRecentTasks()</h2>

<p>With the introduction of the new <em>concurrent documents and activities
tasks</em> feature in Android 5.0 (see <a href="#Recents">Concurrent
documents and activities in the recents screen</a> below),
the <code><a href="../../reference/android/app/ActivityManager.html#getRecentTasks(int, int)">ActivityManager.getRecentTasks()</a></code> method is now deprecated to improve user
privacy. For backward compatibility, this method still returns a small subset of
its data, including the calling application’s own tasks and possibly some other
non-sensitive tasks (such as Home). If your app is using this method to retrieve
its own tasks, use <code><a href="../../reference/android/app/ActivityManager.html#getAppTasks()">getAppTasks()</a></code>
instead to retrieve that information.</p>

<h2 id="64BitSupport">64-Bit Support in the Android NDK</h2>

<p>Android 5.0 introduces support for 64-bit systems. The 64-bit enhancement
  increases address space and improves performance, while still supporting
  existing 32-bit apps fully. The 64-bit support also improves the performance of
  OpenSSL for cryptography. In addition, this release introduces new native
  media NDK APIs, as well as native OpenGL ES (GLES) 3.1 support.</p>

<p>To use the 64-bit support provided in Android 5.0, download and install NDK
  Revision 10c from the
<a href="../../tools/sdk/ndk/index.html">Android NDK page</a>. Refer to the
Revision 10c <a href="../../tools/sdk/ndk/index.html#Revisions">release notes</a>
for more information about important changes and bug fixes to the NDK.</p>

<h2 id="BindService">Binding to a Service</h2>

<p>The
  <code><a href="../../reference/android/content/Context.html#bindService(android.content.Intent, android.content.ServiceConnection, int)">Context.bindService()</a></code>
  method now requires an explicit <code><a href="../../reference/android/content/Intent.html">Intent</a></code>,
and throws an exception if given an implicit intent.
To ensure your app is secure, use an explicit intent when starting or binding
your <code><a href="../../reference/android/app/Service.html">Service</a></code>, and do not declare intent filters for the service.</p>

<h2 id="BehaviorWebView">WebView</h2>

<p>Android 5.0 changes the default behavior for your app.</p>
<ul>
<li><strong>If your app targets API level 21 or higher:</strong>
  <ul>
    <li>The system
  blocks <a href="https://developer.mozilla.org/en-US/docs/Security/MixedContent"
  class="external-link">mixed content</a> and third party cookies by default. To allow mixed
  content and third party cookies, use the
  <code><a href="../../reference/android/webkit/WebSettings.html#setMixedContentMode(int)">setMixedContentMode()</a></code>
and <code><a href="../../reference/android/webkit/CookieManager.html#setAcceptThirdPartyCookies(android.webkit.WebView, boolean)">setAcceptThirdPartyCookies()</a></code>
methods respectively.</li>
    <li>The system now intelligently chooses portions of the HTML
      document to draw. This new default behavior helps to reduce memory
      footprint and increase performance. If you want to
      render the whole document at once, disable this optimization by calling
      <code><a href="../../reference/android/webkit/WebView.html#enableSlowWholeDocumentDraw()">enableSlowWholeDocumentDraw()</a></code>.</li>
  </ul>
</li>
<li><strong>If your app targets API levels lower than 21:</strong> The system
  allows mixed content and third party cookies, and always renders the whole
  document at once.</li>
</ul>

<h2 id="custom_permissions">Uniqueness Requirement for Custom Permissions</h2>

<p>
  As documented in the <a href=
  "../../guide/topics/manifest/manifest-intro.html#perms">Permissions</a>
  overview, Android apps can define custom permissions as a means of managing
  access to components in a proprietary way, without using the platform’s
  pre-defined system permissions. Apps define custom permissions in <a href=
  "http://developer.android.com/guide/topics/manifest/permission-element.html"><code>
  &lt;permission&gt;</code></a> elements declared in their manifest files.
</p>

<p>
  There are a small number of scenarios where defining custom permissions is a
  legitimate and secure approach. However, creating custom permissions is
  sometimes unnecessary and can even introduce potential risk to an app,
  depending on the protection level assigned to the permissions.
</p>

<p>
  Android 5.0 includes a behavior change to ensure
  that only one app can define a given custom permission, unless signed with the
  same key as other apps defining the permission.
</p>

<h3>
  Apps using duplicate custom permissions
</h3>

<p>
  Any app can define any custom permission it wants, so it can happen
  that multiple apps might <strong>define the same custom permission</strong>.
  For example, if two apps offer a similar capability, they might derive the
  same logical name for their custom permissions. Apps might also incorporate
  common public libraries or code examples that themselves include the same
  custom permission definitions.
</p>

<p>
  In Android 4.4 and earlier, users were able to install multiple such
  apps on a given device, although the system assigned the protection level
  specified by the first-installed app.
</p>

<p>
  Starting in Android 5.0, the system enforces a new
  <strong>uniqueness restriction on custom permissions</strong> for
  apps that are signed with different keys. Now only one app on a device can
  define a given custom permission (as determined by its name), unless the
  other app defining the permission is signed with the same key. If the user
  tries to install an app with a duplicate custom permission and is not signed
  with the same key as the resident app that defines the permission, the system
  blocks the installation.
</p>

<h3>
  Considerations for your app
</h3>

<p>
  In Android 5.0 and later, apps can continue to define their own custom
  permissions just as before and to request custom permissions from other apps
  through the <code>&lt;uses-permission&gt;</code> mechanism. However with the
  new requirement introduced in Android 5.0, you should carefully assess
  possible impacts on your app.
</p>

<p>
  Here are some points to consider:
</p>

<ul>
  <li>Does your app declare any <a href=
  "http://developer.android.com/guide/topics/manifest/permission-element.html">
    <code>&lt;permission&gt;</code></a> elements in its manifest? If so, are
    they actually necessary to the proper function of your app or service? Or
    could you use a system default permission instead?
  </li>

  <li>If you have <a href=
  "http://developer.android.com/guide/topics/manifest/permission-element.html">
    <code>&lt;permission&gt;</code></a> elements in your app, do you know where
    they came from?
  </li>

  <li>Do you actually intend for other apps to request your custom permissions
  through <a href=
  "http://developer.android.com/guide/topics/manifest/uses-permission-element.html">
    <code>&lt;uses-permission&gt;</code></a>?
  </li>

  <li>Are you using boilerplate or example code in your app that includes
  <a href=
  "http://developer.android.com/guide/topics/manifest/permission-element.html">
    <code>&lt;permission&gt;</code></a> elements? Are those permission elements
    actually necessary?
  </li>

  <li>Do your custom permissions use names that are simple or based on common
  terms that other apps might share?
  </li>
</ul>

<h3>
  New installs and updates
</h3>

<p>
  As mentioned above, for new installs and updates of your app on devices
  running Android 4.4 or earlier are unaffected and there is no change in
  behavior. For new installs and updates on devices running Android 5.0 or
  later, the system <strong>prevents installation of your app</strong> if it
  defines a custom permission that is already defined by an existing resident
  app.
</p>

<h3>
  Existing installs with Android 5.0 system update
</h3>

<p>
  If your app uses custom permissions and is widely distributed and installed,
  there’s a chance that it will be affected when users receive update their
  devices to Android 5.0. After the system update is installed, the system
  revalidates installed apps, including a check of their custom permissions. If
  your app defines a custom permission that is already defined by another app
  that has already been validated, and your app is not signed with the same key
  as the other app, the system <strong>does not re-install your app</strong>.
</p>

<h3>
  Recommendations
</h3>

<p>
  On devices running Android 5.0 or later, we recommend that you examine your
  app immediately, make any adjustments needed, and publish the updated version
  as soon as possible to your users.
</p>

<ul>
  <li>If you are using custom permissions in your app, consider their origin
  and whether you actually need them. Remove all <a href=
  "http://developer.android.com/guide/topics/manifest/permission-element.html">
    <code>&lt;permission&gt;</code></a> elements from your app, unless you are
    certain that they are required for proper function of your app.
  </li>

  <li>Consider replacing your custom permissions with system default
  permissions where possible.
  </li>

  <li>If your app requires custom permissions, rename your custom permissions
  to be unique to your app, such as by appending them to the full package name
  of your app.
  </li>

  <li>If you have a suite of apps <em>signed with different keys</em> and the apps
  access a shared component by means of a custom permission, make sure that the
  custom permission is only defined once, in the shared component. Apps that
  use the shared component should not define the custom permission themselves,
  but should instead request access through the <a href=
  "../../guide/topics/manifest/uses-permission-element.html">
    <code>&lt;uses-permission&gt;</code></a> mechanism.
  </li>

  <li>If you have a suite of apps are <em>signed with the same key</em>,
  each app can define the same custom permission(s) as <span style="white-space:nowrap;">needed
  &mdash; the</span> system allows the apps to be installed in the usual way.
  </li>

</ul>


<h2 id="ssl">
  TLS/SSL Default Configuration Changes
</h2>

<p>
  Android 5.0 introduces changes the default TLS/SSL configuration used by apps
  for HTTPS and other TLS/SSL traffic:
</p>

<ul>
  <li>TLSv1.2 and TLSv1.1 protocols are now enabled,</li>
  <li>AES-GCM (AEAD) cipher suites are now enabled,</li>
  <li>MD5, 3DES, export, and static key ECDH cipher suites are now disabled,</li>
  <li>Forward Secrecy cipher suites (ECDHE and DHE) are preferred.</li>
</ul>

<p>
  These changes may lead to breakages in HTTPS or TLS/SSL connectivity in a
  small number of cases listed below.
</p>

<p>
  Note that the security ProviderInstaller from Google Play services already
  offers these changes across Android platform versions back to Android 2.3.
</p>

<h3>
  Server does not support any of the enabled ciphers suites
</h3>

<p>
  For example, a server might support only 3DES or MD5 cipher suites. The
  preferred fix is to improve the server’s configuration to enable stronger and
  more modern cipher suites and protocols. Ideally, TLSv1.2 and AES-GCM should
  be enabled, and Forward Secrecy cipher suites (ECDHE, DHE) should be enabled
  and preferred.
</p>

<p>
  An alternative is to modify the app to use a custom SSLSocketFactory to
  communicate with the server. The factory should be designed to create
  SSLSocket instances which have some of the cipher suites required by the
  server enabled in addition to default cipher suites.
</p>

<h3>
  App is making wrong assumptions about cipher suites used to connect to server
</h3>

<p>
  For example, some apps contain a custom X509TrustManager that breaks because
  it expects the authType parameter to be RSA but encounters ECDHE_RSA or
  DHE_RSA.
</p>

<h3>
  Server is intolerant to TLSv1.1, TLSv1.2 or new TLS extensions
</h3>

<p>
  For example, the TLS/SSL handshake with a server is erroneously rejected or
  stalls. The preferred fix is to upgrade the server to comply with the TLS/SSL
  protocol. This will make the server successfully negotiate these newer
  protocols or negotiate TLSv1 or older protocols and ignore TLS extensions it
  does not understand. In some cases disabling TLSv1.1 and TLSv1.2 on the
  server may work as a stopgap measure until the server software is upgraded.
</p>

<p>
  An alternative is to modify the app to use a custom SSLSocketFactory to
  communicate with the server. The factory should be designed to create
  SSLSocket instances with only those protocols enabled which are correctly
  supported by the server.
</p>

<h2 id="managed_profiles">Support for Managed Profiles</h2>

<p>
  Device administrators can add a <em>managed profile</em> to a device. This
  profile is owned by the administrator, giving the administrator control
  over the managed profile while leaving the user's personal profile, and its
  storage space, under the user's control.
  This change can affect the behavior of your existing app in
  the following ways.</p>

<h3 id="mg_profile_intents">Handling intents</h3>

<p>Device administrators can restrict access to system applications from the
managed profile. In this case, if an app fires an intent from the managed
profile that would ordinarily be handled by that application, and there is no
suitable handler for the intent on the managed profile,
the intent causes an exception. For example, the
device administrator can restrict apps on the managed profile from accessing
the system's camera application. If your app is running on the managed profile
and calls <code><a href="../../reference/android/app/Activity.html#startActivityForResult(android.content.Intent, int)">startActivityForResult()</a></code> for <code><a href="../../reference/android/provider/MediaStore.html#ACTION_IMAGE_CAPTURE">MediaStore.ACTION_IMAGE_CAPTURE</a></code>, and there is no app on the managed profile
that can handle the intent, this results in an <code><a href="../../reference/android/content/ActivityNotFoundException.html">ActivityNotFoundException</a></code>.</p>

<p>You can prevent this by checking
that there is at least one handler for any intent
before firing it. To check for a valid handler, call <code><a href="../../reference/android/content/Intent.html#resolveActivity(android.content.pm.PackageManager)">Intent.resolveActivity()</a></code>. You can see
an example of this being done in <a
href="../../training/camera/photobasics.html#TaskCaptureIntent">Take Photos
Simply: Take a Photo with the Camera App</a>.</p>

<h3 id="mp_profile_file_sharing">Sharing files across profiles</h3>

<p>Each profile has its own file storage. Since a file URI refers to a specific
location in the file storage, this means that a file URI that is valid on one
profile is not valid on the other one. This is not ordinarily a problem for an
app, which usually just accesses the files it creates. However, if an app
attaches a file to an intent, it is not safe to attach a file URI, since in some
circumstances, the intent might be handled on the other profile.
For example, a device administrator might specify that image capture events
should be handled by the camera app on the personal profile. If the intent is
fired by an app on the managed profile, the camera needs to be able to write the
image to a location where the managed profile's apps can read it.</p>

<p>To be safe, when
you need to attach a file to an intent that might cross from one profile to the
other, you should create and use a <em>content URI</em> for the file. For more
information about sharing files with content URIs, see <a
href="../../training/secure-file-sharing/index.html">Sharing Files</a>.
For example, the device administrator might whitelist <code><a href="../../reference/android/provider/MediaStore.html#ACTION_IMAGE_CAPTURE">ACTION_IMAGE_CAPTURE</a></code> to be
handled by the camera in the personal profile. The firing intent's <code><a href="../../reference/android/provider/MediaStore.html#EXTRA_OUTPUT">EXTRA_OUTPUT</a></code> should contain a content
URI specifying where the photo should be stored. The camera app can write the
image to the location specified by that URI, and the app that fired the intent
would be able to read that file, even if the app is on the other profile. </p>

<h3>Lockscreen widget support removed</h3>

<p>Android 5.0 removes support for lockscreen widgets; it continues to support
widgets on the home screen.</p>
    </div>

    

  </div> <!-- end jd-content -->

<div class="wrap">
  <div class="dac-footer">
    <div class="cols dac-footer-main">
      <div class="col-1of2">
        <a class="dac-footer-getnews" data-modal-toggle="newsletter" href="javascript:;">Get news &amp; tips <span
          class="dac-fab dac-primary"><i class="dac-sprite dac-mail"></i></span></a>
      </div>
      <div class="col-1of2 dac-footer-reachout">
        <div class="dac-footer-contact">
          <a class="dac-footer-contact-link" href="http://android-developers.blogspot.com/">Blog</a>
          <a class="dac-footer-contact-link" href="../../support.html">Support</a>
        </div>
        <div class="dac-footer-social">
          <a class="dac-fab dac-footer-social-link" href="https://www.youtube.com/user/androiddevelopers"><i class="dac-sprite dac-youtube"></i></a>
          <a class="dac-fab dac-footer-social-link" href="https://plus.google.com/+AndroidDevelopers"><i class="dac-sprite dac-gplus"></i></a>
          <a class="dac-fab dac-footer-social-link" href="https://twitter.com/AndroidDev"><i class="dac-sprite dac-twitter"></i></a>
        </div>
      </div>
    </div>

    <hr class="dac-footer-separator"/>

    
      <p class="dac-footer-copyright">
        
  Except as noted, this content is
  licensed under <a href="http://creativecommons.org/licenses/by/2.5/">
  Creative Commons Attribution 2.5</a>. For details and
  restrictions, see the <a href="../../license.html">Content
  License</a>.
      </p>
    

    <p class="dac-footer-links">
      <a href="../index.html">About Android</a>
      <a href="../../auto/index.html">Auto</a>
      <a href="../../tv/index.html">TV</a>
      <a href="../../wear/index.html">Wear</a>
      <a href="../../legal.html">Legal</a>

      <span id="language" class="locales">
        <select name="language" onchange="changeLangPref(this.value, true)">
          <option value="en" selected="selected">English</option>
          <option value="es">Español</option>
          <option value="ja">日本語</option>
          <option value="ko">한국어</option>
          <option value="pt-br">Português Brasileiro</option>
          <option value="ru">Русский</option>
          <option value="zh-cn">中文（简体)</option>
          <option value="zh-tw">中文（繁體)</option>
        </select>
      </span>
    </p>
  </div>
</div> <!-- end footer -->

<div data-modal="newsletter" data-newsletter data-swap class="dac-modal newsletter">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <button class="dac-modal-header-close" data-modal-toggle><i class="dac-sprite dac-close"></i></button>
        <div class="dac-swap" data-swap-container>
          <section class="dac-swap-section dac-active dac-down">
            <h2 class="norule dac-modal-header-title">Get the latest Android developer news and tips that will help you find success on Google Play.</h2>
            <p class="dac-modal-header-subtitle">&#42; Required Fields</p>
          </section>
          <section class="dac-swap-section dac-up">
            <h2 class="norule dac-modal-header-title">Hooray!</h2>
          </section>
        </div>
      </header>
      <div class="dac-swap" data-swap-container>
        <section class="dac-swap-section dac-active dac-left">
          <form action="https://docs.google.com/forms/d/1QgnkzbEJIDu9lMEea0mxqWrXUJu0oBCLD7ar23V0Yys/formResponse" class="dac-form" method="post" target="dac-newsletter-iframe">
            <section class="dac-modal-content">
              <fieldset class="dac-form-fieldset">
                <div class="cols">
                  <div class="col-1of2 newsletter-leftCol">
                    <div class="dac-form-input-group">
                      <label for="newsletter-full-name" class="dac-form-floatlabel">Full name</label>
                      <input type="text" class="dac-form-input" name="entry.1357890476" id="newsletter-full-name" required>
                      <span class="dac-form-required">*</span>
                    </div>
                    <div class="dac-form-input-group">
                      <label for="newsletter-email" class="dac-form-floatlabel">Email address</label>
                      <input type="email" class="dac-form-input" name="entry.472100832" id="newsletter-email" required>
                      <span class="dac-form-required">*</span>
                    </div>
                  </div>
                  <div class="col-1of2 newsletter-rightCol">
                    <div class="dac-form-input-group">
                      <label for="newsletter-company" class="dac-form-floatlabel">Company / developer name</label>
                      <input type="text" class="dac-form-input" name="entry.1664780309" id="newsletter-company">
                    </div>
                    <div class="dac-form-input-group">
                      <label for="newsletter-play-store" class="dac-form-floatlabel">One of your Play Store app URLs</label>
                      <input type="url" class="dac-form-input" name="entry.47013838" id="newsletter-play-store" required>
                      <span class="dac-form-required">*</span>
                    </div>
                  </div>
                </div>
              </fieldset>
              <fieldset class="dac-form-fieldset">
                <div class="cols">
                  <div class="col-1of2 newsletter-leftCol">
                    <legend class="dac-form-legend">Which best describes your business:<span class="dac-form-required">*</span>
                    </legend>
                    <div class="dac-form-radio-group">
                      <input type="radio" value="Apps" class="dac-form-radio" name="entry.1796324055" id="newsletter-business-type-app" required>
                      <label for="newsletter-business-type-app" class="dac-form-radio-button"></label>
                      <label for="newsletter-business-type-app" class="dac-form-label">Apps</label>
                    </div>
                    <div class="dac-form-radio-group">
                      <input type="radio" value="Games" class="dac-form-radio" name="entry.1796324055" id="newsletter-business-type-games" required>
                      <label for="newsletter-business-type-games" class="dac-form-radio-button"></label>
                      <label for="newsletter-business-type-games" class="dac-form-label">Games</label>
                    </div>
                    <div class="dac-form-radio-group">
                      <input type="radio" value="Apps and Games" class="dac-form-radio" name="entry.1796324055" id="newsletter-business-type-appsgames" required>
                      <label for="newsletter-business-type-appsgames" class="dac-form-radio-button"></label>
                      <label for="newsletter-business-type-appsgames" class="dac-form-label">Apps &amp; Games</label>
                    </div>
                  </div>
                  <div class="col-1of2 newsletter-rightCol newsletter-checkboxes">
                    <div class="dac-form-radio-group">
                      <div class="dac-media">
                        <div class="dac-media-figure">
                          <input type="checkbox" class="dac-form-checkbox" name="entry.732309842" id="newsletter-add" required value="Add me to the mailing list for the monthly newsletter and occasional emails about development and Google Play opportunities.">
                          <label for="newsletter-add" class="dac-form-checkbox-button"></label>
                        </div>
                        <div class="dac-media-body">
                          <label for="newsletter-add" class="dac-form-label dac-form-aside">Add me to the mailing list for the monthly newsletter and occasional emails about development and Google Play opportunities.<span class="dac-form-required">*</span></label>
                        </div>
                      </div>
                    </div>
                    <div class="dac-form-radio-group">
                      <div class="dac-media">
                        <div class="dac-media-figure">
                          <input type="checkbox" class="dac-form-checkbox" name="entry.2045036090" id="newsletter-terms" required value="I acknowledge that the information provided in this form will be subject to Google's privacy policy (https://www.google.com/policies/privacy/).">
                          <label for="newsletter-terms" class="dac-form-checkbox-button"></label>
                        </div>
                        <div class="dac-media-body">
                          <label for="newsletter-terms" class="dac-form-label dac-form-aside">I acknowledge that the information provided in this form will be subject to <a href="https://www.google.com/policies/privacy/">Google's privacy policy</a>.<span class="dac-form-required">*</span></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </fieldset>
            </section>
            <footer class="dac-modal-footer">
              <div class="cols">
                <div class="col-2of5">
                </div>
              </div>
              <button type="submit" value="Submit" class="dac-fab dac-primary dac-large dac-modal-action"><i class="dac-sprite dac-arrow-right"></i></button>
            </footer>
          </form>
        </section>
        <section class="dac-swap-section dac-right">
          <div class="dac-modal-content">
            <p class="newsletter-success-message">
              You have successfully signed up for the latest Android developer news and tips.
            </p>
          </div>
        </section>
      </div>
    </div>
  </div>
</div> <!-- end footer -->

</div><!-- end doc-content -->

</div> <!-- end .cols --> 
</div> <!-- end body-content --> 





  <script src="../../ajax/developer.android.com/ytblogger_lists_unified.js" type="text/javascript"></script>
  <script src="../../jd_lists_unified.js?v=15" type="text/javascript"></script>
  <script src="../../jd_extras.js?v=15" type="text/javascript"></script>
  <script src="../../jd_collections.js?v=15" type="text/javascript"></script>
  <script src="../../jd_tag_helpers.js?v=15" type="text/javascript"></script>

</body>
</html>
