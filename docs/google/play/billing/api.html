<!DOCTYPE html>





























































































<html>
<head>


<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta content="IE=edge" http-equiv="X-UA-Compatible">

<meta name="Description" content="The In-app Billing Version 3 API makes it easier for you to integrate In-app Billing into your applications. The features in this version include improved synchronous purchase flow, APIs to let you easily track ownership of consumable goods, and local…">
<link rel="shortcut icon" type="image/x-icon" href="../../../favicon.ico" />
<title>In-app Billing API | Android Developers</title>

<!-- STYLESHEETS -->
<link rel="stylesheet"
href="http://fonts.useso.com/css?family=Roboto+Condensed">
<link rel="stylesheet" href="http://fonts.useso.com/css?family=Roboto:light,regular,medium,thin,italic,mediumitalic,bold"
  title="roboto">

<link href="../../../assets/css/default.css?v=7" rel="stylesheet" type="text/css">



<!-- JAVASCRIPT -->
<script src="../../../assets/js/android_3p-bundle.js" type="text/javascript"></script>
<script type="text/javascript">
  var toRoot = "../../../";
  var metaTags = ["billing","inapp","iap"];
  var devsite = false;
</script>
<script src="../../../assets/js/docs.js?v=6" type="text/javascript"></script>



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-5831155-1', 'android.com');
  ga('create', 'UA-49880327-2', 'android.com', {'name': 'universal'});  // New tracker);
  ga('send', 'pageview');
  ga('universal.send', 'pageview'); // Send page view for new tracker.
</script>

</head>

<body class="gc-documentation


google develop" itemscope itemtype="http://schema.org/Article">
<a name="top"></a>

<!-- dialog to prompt lang pref change when loaded from hardcoded URL
<div id="langMessage" style="display:none">
  <div>
    <div class="lang en">
      <p>You requested a page in English, would you like to proceed with this language setting?</p>
    </div>
    <div class="lang es">
      <p>You requested a page in Spanish (Español), would you like to proceed with this language setting?</p>
    </div>
    <div class="lang ja">
      <p>You requested a page in Japanese (日本語), would you like to proceed with this language setting?</p>
    </div>
    <div class="lang ko">
      <p>You requested a page in Korean (한국어), would you like to proceed with this language setting?</p>
    </div>
    <div class="lang ru">
      <p>You requested a page in Russian (Русский), would you like to proceed with this language setting?</p>
    </div>
    <div class="lang zh-cn">
      <p>You requested a page in Simplified Chinese (简体中文), would you like to proceed with this language setting?</p>
    </div>
    <div class="lang zh-tw">
      <p>You requested a page in Traditional Chinese (繁體中文), would you like to proceed with this language setting?</p>
    </div>
    <a href="#" class="button yes" onclick="return false;">
      <span class="lang en">Yes</span>
      <span class="lang es">Sí</span>
      <span class="lang ja">Yes</span>
      <span class="lang ko">Yes</span>
      <span class="lang ru">Yes</span>
      <span class="lang zh-cn">是的</span>
      <span class="lang zh-tw">没有</span>
    </a>
    <a href="#" class="button" onclick="$('#langMessage').hide();return false;">
      <span class="lang en">No</span>
      <span class="lang es">No</span>
      <span class="lang ja">No</span>
      <span class="lang ko">No</span>
      <span class="lang ru">No</span>
      <span class="lang zh-cn">没有</span>
      <span class="lang zh-tw">没有</span>
    </a>
  </div>
</div> -->


  <!-- Header -->
  <div id="header-wrapper">
    <div class="dac-header" id="header">




      <div class="dac-header-inner">
        <a class="dac-nav-toggle" data-dac-toggle-nav href="javascript:;" title="Open navigation">
          <span class="dac-nav-hamburger">
            <span class="dac-nav-hamburger-top"></span>
            <span class="dac-nav-hamburger-mid"></span>
            <span class="dac-nav-hamburger-bot"></span>
          </span>
        </a>
        <a class="dac-header-logo" href="../../../index.html">
          <img class="dac-header-logo-image" src="../../../assets/images/android_logo.png"
              srcset="../../../assets/images/android_logo@2x.png 2x"
              width="32" height="36" alt="Android" /> Developers
          </a>

        <ul class="dac-header-crumbs">
          
          <li class="dac-header-crumbs-item"><span class="dac-header-crumbs-link current ">In-app Billing API</a></li>
        </ul>

        
        
        
  <div class="dac-header-search" id="search-container">
    <div class="dac-header-search-inner">
      <div class="dac-sprite dac-search dac-header-search-btn" id="search-btn"></div>
      <form class="dac-header-search-form" onsubmit="return submit_search()">
        <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q"
          onfocus="search_focus_changed(this, true)" onblur="search_focus_changed(this, false)"
          onkeydown="return search_changed(event, true, '../../../')"
          onkeyup="return search_changed(event, false, '../../../')"
          class="dac-header-search-input" placeholder="Search" />
          <a class="dac-header-search-close hide" id="search-close">close</a>
      </form>
    </div><!-- end dac-header-search-inner -->
  </div><!-- end dac-header-search -->

  <div class="search_filtered_wrapper">
    <div class="suggest-card reference no-display">
      <ul class="search_filtered">
      </ul>
    </div>
    <div class="suggest-card develop no-display">
      <ul class="search_filtered">
      </ul>
      <div class="child-card guides no-display">
      </div>
      <div class="child-card training no-display">
      </div>
      <div class="child-card samples no-display">
      </div>
    </div>
    <div class="suggest-card design no-display">
      <ul class="search_filtered">
      </ul>
    </div>
    <div class="suggest-card distribute no-display">
      <ul class="search_filtered">
      </ul>
    </div>
  </div>

        

        <a class="dac-header-console-btn" href="https://play.google.com/apps/publish/">
          <span class="dac-sprite dac-google-play"></span>
          <span class="dac-visible-desktop-inline">Developer</span>
          Console
        </a>

      </div><!-- end header-wrap.wrap -->
    </div><!-- end header -->

    <div id="searchResults" class="wrap" style="display:none;">
      <h2 id="searchTitle">Results</h2>
      <div id="leftSearchControl" class="search-control">Loading...</div>
    </div>
  </div> <!--end header-wrapper -->

  
  <!-- Navigation-->
  <nav class="dac-nav">
    <div class="dac-nav-dimmer" data-dac-toggle-nav></div>

    <ul class="dac-nav-list" data-dac-nav>
      <li class="dac-nav-item dac-nav-head">
        <a class="dac-nav-link dac-nav-logo" data-dac-toggle-nav href="javascript:;" title="Close navigation">
          <img class="dac-logo-image" src="../../../assets/images/android_logo.png"
               srcset="../../../assets/images/android_logo@2x.png 2x"
               width="32" height="36" alt="Android" /> Developers
        </a>
      </li>
      <li class="dac-nav-item home">
        <a class="dac-nav-link dac-visible-mobile-block" href="../../../index.html">Home</a>
        <ul class="dac-nav-secondary about">
          <li class="dac-nav-item about">
            <a class="dac-nav-link" href="../../../about/index.html">Android</a>
          </li>
          <li class="dac-nav-item wear">
            <a class="dac-nav-link" href="../../../wear/index.html">Wear</a>
          </li>
          <li class="dac-nav-item tv">
            <a class="dac-nav-link" href="../../../tv/index.html">TV</a>
          </li>
          <li class="dac-nav-item auto">
            <a class="dac-nav-link" href="../../../auto/index.html">Auto</a>
          </li>
        </ul>
      </li>
      <li class="dac-nav-item design">
        <a class="dac-nav-link" href="../../../design/index.html"
           zh-tw-lang="設計"
           zh-cn-lang="设计"
           ru-lang="Проектирование"
           ko-lang="디자인"
           ja-lang="設計"
           es-lang="Diseñar">Design</a>
      </li>
      <li class="dac-nav-item develop">
        <a class="dac-nav-link" href="../../../develop/index.html"
           zh-tw-lang="開發"
           zh-cn-lang="开发"
           ru-lang="Разработка"
           ko-lang="개발"
           ja-lang="開発"
           es-lang="Desarrollar">Develop</a>
        <ul class="dac-nav-secondary develop">
          <li class="dac-nav-item training">
            <a class="dac-nav-link" href="../../../training/index.html"
               zh-tw-lang="訓練課程"
               zh-cn-lang="培训"
               ru-lang="Курсы"
               ko-lang="교육"
               ja-lang="トレーニング"
               es-lang="Capacitación">Training</a>
          </li>
          <li class="dac-nav-item guide">
            <a class="dac-nav-link" href="../../../guide/index.html"
               zh-tw-lang="API 指南"
               zh-cn-lang="API 指南"
               ru-lang="Руководства по API"
               ko-lang="API 가이드"
               ja-lang="API ガイド"
               es-lang="Guías de la API">API Guides</a>
          </li>
          <li class="dac-nav-item reference">
            <a class="dac-nav-link" href="../../../reference/packages.html"
               zh-tw-lang="參考資源"
               zh-cn-lang="参考"
               ru-lang="Справочник"
               ko-lang="참조문서"
               ja-lang="リファレンス"
               es-lang="Referencia">Reference</a>
          </li>
          <li class="dac-nav-item tools">
            <a class="dac-nav-link" href="../../../sdk/index.html"
               zh-tw-lang="相關工具"
               zh-cn-lang="工具"
               ru-lang="Инструменты"
               ko-lang="도구"
               ja-lang="ツール"
               es-lang="Herramientas">Tools</a></li>
          <li class="dac-nav-item google">
            <a class="dac-nav-link" href="../../../google/index.html">Google Services</a>
          </li>
          
          <li class="dac-nav-item preview">
            <a class="dac-nav-link" href="../../../preview/index.html">Preview</a>
          </li>
        </ul>
      </li>
      <li class="dac-nav-item distribute">
        <a class="dac-nav-link" href="../../../distribute/googleplay/index.html"
           zh-tw-lang="發佈"
           zh-cn-lang="分发"
           ru-lang="Распространение"
           ko-lang="배포"
           ja-lang="配布"
           es-lang="Distribuir">Distribute</a>
        <ul class="dac-nav-secondary distribute">
          <li class="dac-nav-item googleplay">
            <a class="dac-nav-link" href="../../../distribute/googleplay/index.html">Google Play</a></li>
          <li class="dac-nav-item essentials">
            <a class="dac-nav-link" href="../../../distribute/essentials/index.html">Essentials</a></li>
          <li class="dac-nav-item users">
            <a class="dac-nav-link" href="../../../distribute/users/index.html">Get Users</a></li>
          <li class="dac-nav-item engage">
            <a class="dac-nav-link" href="../../../distribute/engage/index.html">Engage &amp; Retain</a></li>
          <li class="dac-nav-item monetize">
            <a class="dac-nav-link" href="../../../distribute/monetize/index.html">Earn</a>
          </li>
          <li class="dac-nav-item analyze">
            <a class="dac-nav-link" href="../../../distribute/analyze/index.html">Analyze</a>
          </li>
          <li class="dac-nav-item stories">
            <a class="dac-nav-link" href="../../../distribute/stories/index.html">Stories</a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>
  <!-- end navigation-->
  




  <div class="wrap clearfix" id="body-content"><div class="cols">
    <div class="col-4 dac-toggle dac-mobile" id="side-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
      
  <div class="dac-visible-mobile-block" data-toggle="section">
    <span class="dac-toggle-expand dac-devdoc-toggle"><i class="dac-sprite dac-expand-more-black"></i> Show navigation</span>
    <span class="dac-toggle-collapse dac-devdoc-toggle" data-toggle-section><i class="dac-sprite dac-expand-less-black"></i> Hide navigation</span>
  </div>

      <div class="dac-toggle-content" id="devdoc-nav">
        <div class="scroll-pane">
<ul id="nav">

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../../google/play/billing/index.html" zh-cn-lang="应用内结算">
      <span class="en">Google Play In-app Billing</span></a>
    </div>
    <ul>
      <li><a href="../../../google/play/billing/billing_overview.html" zh-cn-lang="应用内结算概述">
              <span class="en">Overview</span></a>
      </li>
      <li class="nav-section"><div class="nav-section-header"><a href="../../../google/play/billing/api.html" zh-cn-lang="应用内结算 API">
              <span class="en">Version 3 API</span></a></div>
              <ul>
              <li><a href="../../../google/play/billing/billing_integrate.html">
              <span class="en">Implementing the API</span></a></li>
              <li><a href="../../../google/play/billing/billing_reference.html">
              <span class="en">Reference</span></a></li>
              </ul>
      </li>
      <li class="nav-section"><div class="nav-section-header"><a href="../../../google/play/billing/v2/api.html">
              <span class="en">Version 2 API</span></a></div>
              <ul>
              <li><a href="../../../google/play/billing/v2/billing_integrate.html">
              <span class="en">Implementing the API</span></a></li>
              <li><a href="../../../google/play/billing/v2/billing_subscriptions.html">
              <span class="en">Subscriptions</span></a></li>
              <li><a href="../../../google/play/billing/v2/billing_reference.html">
              <span class="en">Reference</span></a></li>
              </ul>
      </li>
      <li><a href="../../../google/play/billing/billing_subscriptions.html">
              <span class="en">Subscriptions</span></a>
      </li>
      <li><a href="../../../google/play/billing/billing_best_practices.html" zh-cn-lang="安全性和设计">
              <span class="en">Security and Design</span></a>
      </li>
      <li><a href="../../../google/play/billing/billing_testing.html" zh-cn-lang="测试应用内结算">
              <span class="en">Testing In-app Billing</span></a>
      </li>
      <li><a href="../../../google/play/billing/billing_admin.html" zh-cn-lang="管理应用内结算">
              <span class="en">Administering In-app Billing</span></a>
      </li>
      <li><a href="../../../google/play/billing/versions.html">
              <span class="en">Version Notes</span></a>
      </li>
    </ul>
  </li>

  <li class="nav-section">
  <div class="nav-section-header empty"><a href="../../../google/play/filters.html"
       es-lang="Filtros en Google Play"
       ja-lang="Google Play 上のフィルタ"
       ko-lang="Google Play 필터"
       pt-br-lang="Filtros no Google Play"
       ru-lang="Фильтры в Google Play"
       zh-cn-lang="Google Play 上的筛选器"
       zh-tw-lang="Google Play 上的篩選器">
          Filters on Google Play</a>
      </div>
  </li>

  <li class="nav-section">
  <div class="nav-section-header empty"><a href="../../../google/play/developer-api.html">
              <span class="en">Google Play Developer API</span></a>
      </div>
  </li>
    <li class="nav-section">
  <div class="nav-section-header empty"><a href="../../../google/play/publishing/multiple-apks.html">
          <span class="en">Multiple APK Support</span></a>
      </div>
  </li>
    <li class="nav-section">
  <div class="nav-section-header empty"><a href="../../../google/play/expansion-files.html">
          <span class="en">APK Expansion Files</span></a>
      </div>
  </li>


  <li class="nav-section">

        <div class="nav-section-header"><a href="../../../google/play/licensing/index.html">
          <span class="en">Application Licensing</span></a>
        </div>
        <ul>
          <li><a href="../../../google/play/licensing/overview.html">
              <span class="en">Licensing Overview</span></a>
          </li>
          <li><a href="../../../google/play/licensing/setting-up.html">
              <span class="en">Setting Up for Licensing</span></a>
          </li>
          <li><a href="../../../google/play/licensing/adding-licensing.html">
              <span class="en">Adding Licensing to Your App</span></a>
          </li>
          <li><a href="../../../google/play/licensing/licensing-reference.html">
              <span class="en">Licensing Reference</span></a>
          </li>
        </ul>
      </li>

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../../google/backup/index.html">
      Android Backup Service</a>
    </div>
    <ul>
      <li><a href="../../../google/backup/signup.html">
          Register</a>
      </li>
    </ul>
  </li>

  </ul>

</li>



</ul>

<script type="text/javascript">
<!--
    buildToggleLists();
    changeNavLang(getLangPref());
//-->
</script>


        </div>
      </div>
      <script type="text/javascript">
       showGoogleRefTree();
    
      </script>
    </div> <!-- end side-nav -->
    <script>
      $(document).ready(function() {
        scrollIntoView("devdoc-nav");
        });
    </script>




<div class="col-12" id="doc-col" >


  

  
    
      
        <h1 itemprop="name" >In-app Billing API</h1>
      
    
  


  
  <div id="jd-content">


    <div class="jd-descr" itemprop="articleBody">
    <div id="qv-wrapper">
<div id="qv">

  <h2>Topics</h2>
  <ol>
    <li><a href="#producttypes">Product Types</a>
       <ol>
       <li><a href="#managed">Managed In-app Products</a><li>
       <li><a href="#subs">Subscriptions</a><li>
       </ol>
    </li>
    <li><a href="#purchase">Purchasing Items</a></li>
    <li><a href="#consume">Consuming In-app Products</a>
       <ol>
       <li><a href="#consumetypes">Non-consumable and Consumable In-app Products</a><li>
       <li><a href="#managingconsumables">Managing Consumable Purchases</a><li>
       </ol>
    </li>
    <li><a href="#caching">Local Caching</a></li>
  </ol>
  
  <h2>Reference</h2>
  <ol>
    <li><a href="../../../google/play/billing/billing_reference.html">In-app Billing
    Reference (V3)</a></li>
  </ol>
  
 <h2>See also</h2>
  <ol>
    <li><a href="../../../training/in-app-billing/index.html">Selling In-app Products</a></li>
  </ol>  
</div>
</div>

<p>The In-app Billing Version 3 API makes it easier for you to integrate In-app Billing into your applications. The features in this version include improved synchronous purchase flow, APIs to let you easily track ownership of consumable goods, and local caching of in-app purchase data.</p>

<h2 id="producttypes">Product Types</h2>
<p>You define your products using the Google Play Developer Console, including product type, SKU, price, description, and so on. For more information, see <a
href="../../../google/play/billing/billing_admin.html">Administering In-app Billing</a>. The Version 3 API supports managed in-app products and subscriptions.</p>
<h3 id="managed">Managed In-app Products</h3>
<p>Managed in-app products are items that have their ownership information tracked and managed by Google Play. When a user purchases a managed in-app item, Google Play stores the purchase information for each item on a per-user basis. This enables you to later query Google Play at any time to restore the state of the items a specific user has purchased. This information is persistent on the Google Play servers even if the user uninstalls the application or if they change devices.</p>
<p>If you are using the Version 3 API, you can also consume managed items within your application. You would typically implement consumption for items that can be purchased multiple times (such as in-game currency, fuel, or magic spells). Once purchased, a managed item cannot be purchased again until you consume the item, by sending a consumption request to Google Play. To learn more about in-app product consumption, see <a href="#consume">Consuming Items</a></p>

<h3 id="subs">Subscriptions</h3>
<p>A subscription is a product type offered in In-app Billing that lets you sell 
content, services, or features to users from inside your app with recurring 
monthly or annual billing. You can sell subscriptions to almost any type of 
digital content, from any type of app or game. To understand how  
subscriptions work, see <a href="../../../google/play/billing/billing_subscriptions.html">In-app Billing Subscriptions</a>.</p>
<p>With the Version 3 API, you can use the same purchase flow for buying 
subscriptions and retrieving subscription purchase information as with in-app 
products. For a code example, see <a href="../../../google/play/billing/billing_integrate.html#Subs">Implementing Subscriptions</a>.</p>
<p class="caution"><strong>Important</strong>: Unlike in-app products, 
subscriptions cannot be consumed.</p>

<h2 id="purchase">Purchasing Items</h2>

<div class="figure" style="width:430px">
<img src="../../../images/in-app-billing/v3/iab_v3_purchase_flow.png" id="figure1" height="530"/>
<p class="img-caption">
  <strong>Figure 1.</strong> The basic sequence for a purchase request.
</p>
</div>

<p>A typical purchase flow with the Version 3 API is as follows:
<ol>
<li>Your application sends a <code>isBillingSupported</code> request to Google Play to determine that the target version of the In-app Billing API that you are using is supported.  </li>
<li>When your application starts or user logs in, it's good practice to check with Google Play to determine what items are owned by the user. To query the user's in-app purchases, send a <code>getPurchases</code> request. If the request is successful, Google Play returns a <code>Bundle</code> containing a list of product IDs of the purchased items, a list of the individual purchase details, and a list of the signatures for the purchases.</li>
<li>Usually, you'll want to inform the user of the products that are available for purchase. To query the details of the in-app products that you defined in Google Play, your application can send a <code>getSkuDetails</code> request. You must specify a list of product IDs in the query request. If the request is successful, Google Play returns a <code>Bundle</code> containing product details including the product’s price, title, description, and the purchase type. 
</li>
<li>If an in-app product is not owned by the user, you can initiate a purchase for it. To start a purchase request, your application sends a <code>getBuyIntent</code> request, specifying the product ID of the item to purchase, along with other parameters. You should record the product ID when you create a new in-app product in the Developer Console.
  <ol type="a">
  <li>Google Play returns a <code>Bundle</code> that contains a <code>PendingIntent</code> which you application uses to start the checkout UI for the purchase.</li>
  <li>Your application launches the pending intent by calling the <code>startIntentSenderForResult</code> method.</li>
  <li>When the checkout flow finishes (that is, the user successfully purchases the item or cancels the purchase), Google Play sends a response <code>Intent</code> to your <code>onActivityResult</code> method. The result code of the <code>onActivityResult</code> has a result code that indicates whether the purchase was successful or canceled. The response <code>Intent</code> contains information about the purchased item, including a <code>purchaseToken</code> String that is generated by Google Play to uniquely identify this purchase transaction. The <code>Intent</code> also contains the signature of the purchase, signed with your private developer key.</li> 
  </ol>
</li>
</ol>
</p>
<p>To learn more about the Version 3 API calls and server responses, see <a href="../../../google/play/billing/billing_reference.html">In-app Billing Reference</a>.</p>

<h2 id="consume">Consuming In-app Products</h2>
<p>You can use the consumption mechanism to track the user's ownership of in-app 
products.</p>
<p>In Version 3, all in-app products are managed. This means that the user's 
ownership of all in-app item purchases is maintained by Google Play, and your 
application can query the user's purchase information when needed. When the user 
successfully purchases an in-app product, that purchase is recorded in Google 
Play. Once an in-app product is purchased, it is considered to be "owned". 
In-app products in the "owned" state cannot be purchased from Google Play. You 
must send a consumption request for the "owned" in-app product before Google 
Play makes it available for purchase again. Consuming the in-app product reverts 
it to the "unowned" state, and discards the previous purchase data.</p>
<div class="figure" style="width:420px">
<img src="../../../images/in-app-billing/v3/iab_v3_consumption_flow.png" id="figure2" height="300"/>
<p class="img-caption">
  <strong>Figure 2.</strong> The basic sequence for a consumption request.
</p>
</div>
<p>To retrieve the list of product's owned by the user, your application sends a <code>getPurchases</code> call to Google Play. Your application can make a consumption request by sending a <code>consumePurchase</code> call. In the request argument, you must specify the in-app product's unique <code>purchaseToken</code> String that you obtained from Google Play when it was purchased. Google Play returns a status code indicating if the consumption was recorded successfully.</p>

<h3 id="consumetypes">Non-consumable and Consumable In-app Products</h3>
<p>It's up to you to decide if you want to handle your in-app products as non-consumable or consumable items.</p>
<dl>
<dt>Non-consumable Items</dt>
<dd>Typically, you would not implement consumption for in-app products that can only be purchased once in your application and provide a permanent benefit. Once purchased, these items will be permanently associated to the user's Google account. An example of a non-consumable in-app product is a premium upgrade or a level pack.</dd>
<dt>Consumable items</dt>
<dd>In contrast, you can implement consumption for items that can be made available for purchase multiple times. Typically, these items provide certain temporary effects. For example, the user's in-game character might gain life points or gain extra gold coins in their inventory. Dispensing the benefits or effects of the purchased item in your application is called <em>provisioning</em> the in-app product. You are responsible for controlling and tracking how in-app products are provisioned to the users.
<p class="note"><strong>Important:</strong> Before provisioning the consumable in-app product in your application, you must send a consumption request to Google Play and receive a successful response indicating that the consumption was recorded.</p>
</dd>
</dl>
<h3 id="managingconsumables">Managing consumable purchases in your application</h3>
<p>Here is the basic flow for purchasing a consumable in-app product:</p>
<ol>
<li>Launch a purchase flow with a <code>getBuyIntent</code> call</li>
<li>Get a response <code>Bundle</code>from Google Play indicating if the purchase completed successfully.</li>
<li>If the purchase was successful, consume the purchase by making a <code>consumePurchase</code> call.</li>
<li>Get a response code from Google Play indicating if the consumption completed successfully.</li>
<li>If the consumption was successful, provision the product in your application.</li>
</ol>
<p>Subsequently, when the user starts up or logs in to your application, you should check if the user owns any outstanding consumable in-app products; if so, make sure to consume and provision those items. Here's the recommended application startup flow if you implement consumable in-app products in your application:</p>
<ol>
<li>Send a <code>getPurchases</code> request to query the owned in-app products for the user.</li>
<li>If there are any consumable in-app products, consume the items by calling <code>consumePurchase</code>. This step is necessary because the application might have completed the purchase order for the consumable item, but stopped or got disconnected before the application had the chance to send a consumption request.</li>
<li>Get a response code from Google Play indicating if the consumption completed successfully.</li>
<li>If the consumption was successful, provision the product in your application.</li>
</ol>

<h2 id="caching">Local Caching</h2>
<p>Because the Google Play client now caches In-app Billing information locally on the device, you can use the Version 3 API to query for this information more frequently, for example through a <code>getPurchases</code> call. Unlike with previous versions of the API, many Version 3 API calls will be serviced through cache lookups instead of through a network connection to Google Play, which significantly speeds up the API's response time. </p>



    </div>

    

  </div> <!-- end jd-content -->

<div class="wrap">
  <div class="dac-footer">
    <div class="cols dac-footer-main">
      <div class="col-1of2">
        <a class="dac-footer-getnews" data-modal-toggle="newsletter" href="javascript:;">Get news &amp; tips <span
          class="dac-fab dac-primary"><i class="dac-sprite dac-mail"></i></span></a>
      </div>
      <div class="col-1of2 dac-footer-reachout">
        <div class="dac-footer-contact">
          <a class="dac-footer-contact-link" href="http://android-developers.blogspot.com/">Blog</a>
          <a class="dac-footer-contact-link" href="/support.html">Support</a>
        </div>
        <div class="dac-footer-social">
          <a class="dac-fab dac-footer-social-link" href="https://www.youtube.com/user/androiddevelopers"><i class="dac-sprite dac-youtube"></i></a>
          <a class="dac-fab dac-footer-social-link" href="https://plus.google.com/+AndroidDevelopers"><i class="dac-sprite dac-gplus"></i></a>
          <a class="dac-fab dac-footer-social-link" href="https://twitter.com/AndroidDev"><i class="dac-sprite dac-twitter"></i></a>
        </div>
      </div>
    </div>

    <hr class="dac-footer-separator"/>

    
      <p class="dac-footer-copyright">
        
  Except as noted, this content is
  licensed under <a href="http://creativecommons.org/licenses/by/2.5/">
  Creative Commons Attribution 2.5</a>. For details and
  restrictions, see the <a href="../../../license.html">Content
  License</a>.
      </p>
    

    <p class="dac-footer-links">
      <a href="/about/index.html">About Android</a>
      <a href="/auto/index.html">Auto</a>
      <a href="/tv/index.html">TV</a>
      <a href="/wear/index.html">Wear</a>
      <a href="/legal.html">Legal</a>

      <span id="language" class="locales">
        <select name="language" onchange="changeLangPref(this.value, true)">
          <option value="en" selected="selected">English</option>
          <option value="es">Español</option>
          <option value="ja">日本語</option>
          <option value="ko">한국어</option>
          <option value="pt-br">Português Brasileiro</option>
          <option value="ru">Русский</option>
          <option value="zh-cn">中文（简体)</option>
          <option value="zh-tw">中文（繁體)</option>
        </select>
      </span>
    </p>
  </div>
</div> <!-- end footer -->

<div data-modal="newsletter" data-newsletter data-swap class="dac-modal newsletter">
  <div class="dac-modal-container">
    <div class="dac-modal-window">
      <header class="dac-modal-header">
        <button class="dac-modal-header-close" data-modal-toggle><i class="dac-sprite dac-close"></i></button>
        <div class="dac-swap" data-swap-container>
          <section class="dac-swap-section dac-active dac-down">
            <h2 class="norule dac-modal-header-title">Get the latest Android developer news and tips that will help you find success on Google Play.</h2>
            <p class="dac-modal-header-subtitle">&#42; Required Fields</p>
          </section>
          <section class="dac-swap-section dac-up">
            <h2 class="norule dac-modal-header-title">Hooray!</h2>
          </section>
        </div>
      </header>
      <div class="dac-swap" data-swap-container>
        <section class="dac-swap-section dac-active dac-left">
          <form action="https://docs.google.com/forms/d/1QgnkzbEJIDu9lMEea0mxqWrXUJu0oBCLD7ar23V0Yys/formResponse" class="dac-form" method="post" target="dac-newsletter-iframe">
            <section class="dac-modal-content">
              <fieldset class="dac-form-fieldset">
                <div class="cols">
                  <div class="col-1of2 newsletter-leftCol">
                    <div class="dac-form-input-group">
                      <label for="newsletter-full-name" class="dac-form-floatlabel">Full name</label>
                      <input type="text" class="dac-form-input" name="entry.1357890476" id="newsletter-full-name" required>
                      <span class="dac-form-required">*</span>
                    </div>
                    <div class="dac-form-input-group">
                      <label for="newsletter-email" class="dac-form-floatlabel">Email address</label>
                      <input type="email" class="dac-form-input" name="entry.472100832" id="newsletter-email" required>
                      <span class="dac-form-required">*</span>
                    </div>
                  </div>
                  <div class="col-1of2 newsletter-rightCol">
                    <div class="dac-form-input-group">
                      <label for="newsletter-company" class="dac-form-floatlabel">Company / developer name</label>
                      <input type="text" class="dac-form-input" name="entry.1664780309" id="newsletter-company">
                    </div>
                    <div class="dac-form-input-group">
                      <label for="newsletter-play-store" class="dac-form-floatlabel">One of your Play Store app URLs</label>
                      <input type="url" class="dac-form-input" name="entry.47013838" id="newsletter-play-store" required>
                      <span class="dac-form-required">*</span>
                    </div>
                  </div>
                </div>
              </fieldset>
              <fieldset class="dac-form-fieldset">
                <div class="cols">
                  <div class="col-1of2 newsletter-leftCol">
                    <legend class="dac-form-legend">Which best describes your business:<span class="dac-form-required">*</span>
                    </legend>
                    <div class="dac-form-radio-group">
                      <input type="radio" value="Apps" class="dac-form-radio" name="entry.1796324055" id="newsletter-business-type-app" required>
                      <label for="newsletter-business-type-app" class="dac-form-radio-button"></label>
                      <label for="newsletter-business-type-app" class="dac-form-label">Apps</label>
                    </div>
                    <div class="dac-form-radio-group">
                      <input type="radio" value="Games" class="dac-form-radio" name="entry.1796324055" id="newsletter-business-type-games" required>
                      <label for="newsletter-business-type-games" class="dac-form-radio-button"></label>
                      <label for="newsletter-business-type-games" class="dac-form-label">Games</label>
                    </div>
                    <div class="dac-form-radio-group">
                      <input type="radio" value="Apps and Games" class="dac-form-radio" name="entry.1796324055" id="newsletter-business-type-appsgames" required>
                      <label for="newsletter-business-type-appsgames" class="dac-form-radio-button"></label>
                      <label for="newsletter-business-type-appsgames" class="dac-form-label">Apps &amp; Games</label>
                    </div>
                  </div>
                  <div class="col-1of2 newsletter-rightCol newsletter-checkboxes">
                    <div class="dac-form-radio-group">
                      <div class="dac-media">
                        <div class="dac-media-figure">
                          <input type="checkbox" class="dac-form-checkbox" name="entry.732309842" id="newsletter-add" required value="Add me to the mailing list for the monthly newsletter and occasional emails about development and Google Play opportunities.">
                          <label for="newsletter-add" class="dac-form-checkbox-button"></label>
                        </div>
                        <div class="dac-media-body">
                          <label for="newsletter-add" class="dac-form-label dac-form-aside">Add me to the mailing list for the monthly newsletter and occasional emails about development and Google Play opportunities.<span class="dac-form-required">*</span></label>
                        </div>
                      </div>
                    </div>
                    <div class="dac-form-radio-group">
                      <div class="dac-media">
                        <div class="dac-media-figure">
                          <input type="checkbox" class="dac-form-checkbox" name="entry.2045036090" id="newsletter-terms" required value="I acknowledge that the information provided in this form will be subject to Google's privacy policy (https://www.google.com/policies/privacy/).">
                          <label for="newsletter-terms" class="dac-form-checkbox-button"></label>
                        </div>
                        <div class="dac-media-body">
                          <label for="newsletter-terms" class="dac-form-label dac-form-aside">I acknowledge that the information provided in this form will be subject to <a href="https://www.google.com/policies/privacy/">Google's privacy policy</a>.<span class="dac-form-required">*</span></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </fieldset>
            </section>
            <footer class="dac-modal-footer">
              <div class="cols">
                <div class="col-2of5">
                </div>
              </div>
              <button type="submit" value="Submit" class="dac-fab dac-primary dac-large dac-modal-action"><i class="dac-sprite dac-arrow-right"></i></button>
            </footer>
          </form>
        </section>
        <section class="dac-swap-section dac-right">
          <div class="dac-modal-content">
            <p class="newsletter-success-message">
              You have successfully signed up for the latest Android developer news and tips.
            </p>
          </div>
        </section>
      </div>
    </div>
  </div>
</div> <!-- end footer -->

</div><!-- end doc-content -->

</div> <!-- end .cols --> 
</div> <!-- end body-content --> 





  <script src="../../../ajax/developer.android.com/ytblogger_lists_unified.js" type="text/javascript"></script>
  <script src="../../../jd_lists_unified.js?v=15" type="text/javascript"></script>
  <script src="../../../jd_extras.js?v=15" type="text/javascript"></script>
  <script src="../../../jd_collections.js?v=15" type="text/javascript"></script>
  <script src="../../../jd_tag_helpers.js?v=15" type="text/javascript"></script>

</body>
</html>
