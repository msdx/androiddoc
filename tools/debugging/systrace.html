<!DOCTYPE html>



















































































<html>
<head>


<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width" />

<meta name="Description" content="After building features, eliminating bugs, and cleaning up your code, you should spend some time looking at the performance of your application. The speed and smoothness with which your application draws pixels and performs operations has an significant…">
<link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico" />
<title>Analyzing Display and Performance | Android Developers</title>

<!-- STYLESHEETS -->
<link rel="stylesheet"
href="http://fonts.googleapis.com/css?family=Roboto+Condensed">
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:light,regular,medium,thin,italic,mediumitalic,bold"
  title="roboto">
<link href="../../assets/css/default.css" rel="stylesheet" type="text/css">



<!-- JAVASCRIPT -->
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script src="../../assets/js/android_3p-bundle.js" type="text/javascript"></script>
<script type="text/javascript">
  var toRoot = "../../";
  var metaTags = ["systrace","speed"];
  var devsite = false;
</script>
<script src="../../assets/js/docs.js" type="text/javascript"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-5831155-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>

<body class="gc-documentation 

develop" itemscope itemtype="http://schema.org/Article">

<a name="top"></a>

  <!-- Header -->
  <div id="header-wrapper">
    <div id="header">
      <div class="wrap" id="header-wrap">
        <div class="col-3 logo">
          <a href="../../index.html">
            <img src="../../assets/images/dac_logo.png"
                srcset="../../assets/images/dac_logo@2x.png 2x"
                width="123" height="25" alt="Android Developers" />
          </a>
          <div class="btn-quicknav" id="btn-quicknav">
            <a href="#" class="arrow-inactive">Quicknav</a>
            <a href="#" class="arrow-active">Quicknav</a>
          </div>
        </div>
        <ul class="nav-x col-9">
            <li class="design">
              <a href="../../design/index.html"
              zh-tw-lang="設計"
              zh-cn-lang="设计"
              ru-lang="Проектирование"
              ko-lang="디자인"
              ja-lang="設計"
              es-lang="Diseñar"
              >Design</a></li>
            <li class="develop"><a href="../../develop/index.html"
              zh-tw-lang="開發"
              zh-cn-lang="开发"
              ru-lang="Разработка"
              ko-lang="개발"
              ja-lang="開発"
              es-lang="Desarrollar"
              >Develop</a></li>
            <li class="distribute last"><a href="../../distribute/googleplay/index.html"
              zh-tw-lang="發佈"
              zh-cn-lang="分发"
              ru-lang="Распространение"
              ko-lang="배포"
              ja-lang="配布"
              es-lang="Distribuir"
              >Distribute</a></li>
        </ul>


        
        
<div class="menu-container">
  <div class="moremenu">
    <div id="more-btn"></div>
  </div>
  <div class="morehover" id="moremenu">
    <div class="top"></div>
    <div class="mid">
      <div class="header">Links</div>
      <ul>
        <li><a href="https://play.google.com/apps/publish/" target="_googleplay">Google Play Developer Console</a></li>
        <li><a href="http://android-developers.blogspot.com/">Android Developers Blog</a></li>
        <li><a href="../../about/index.html">About Android</a></li>
      </ul>
      <div class="header">Android Sites</div>
      <ul>
        <li><a href="http://www.android.com">Android.com</a></li>
        <li class="active"><a>Android Developers</a></li>
        <li><a href="http://source.android.com">Android Open Source Project</a></li>
      </ul>

      
      
      
      <br class="clearfix" />
    </div><!-- end 'mid' -->
    <div class="bottom"></div>
  </div><!-- end 'moremenu' -->

  <div class="search" id="search-container">
    <div class="search-inner">
      <div id="search-btn"></div>
      <div class="left"></div>
      <form onsubmit="return submit_search()">
        <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q"
          onfocus="search_focus_changed(this, true)" onblur="search_focus_changed(this, false)"
          onkeydown="return search_changed(event, true, '../../')"
          onkeyup="return search_changed(event, false, '../../')" />
      </form>
      <div class="right"></div>
      <a class="close hide">close</a>
      <div class="left"></div>
      <div class="right"></div>
    </div><!-- end search-inner -->
  </div><!-- end search-container -->

  <div class="search_filtered_wrapper reference">
    <div class="suggest-card reference no-display">
      <ul class="search_filtered">
      </ul>
    </div>
  </div>

  <div class="search_filtered_wrapper docs">
    <div class="suggest-card dummy no-display">&nbsp;</div>
    <div class="suggest-card develop no-display">
      <ul class="search_filtered">
      </ul>
      <div class="child-card guides no-display">
      </div>
      <div class="child-card training no-display">
      </div>
      <div class="child-card samples no-display">
      </div>
    </div>
    <div class="suggest-card design no-display">
      <ul class="search_filtered">
      </ul>
    </div>
    <div class="suggest-card distribute no-display">
      <ul class="search_filtered">
      </ul>
    </div>
  </div>
</div><!-- end menu-container (search and menu widget) -->



        <!-- Expanded quicknav -->
        <div id="quicknav" class="col-9">
          <ul>
            <li class="design">
              <ul>
                <li><a href="../../design/index.html">Get Started</a></li>
                <li><a href="../../design/style/index.html">Style</a></li>
                <li><a href="../../design/patterns/index.html">Patterns</a></li>
                <li><a href="../../design/building-blocks/index.html">Building Blocks</a></li>
                <li><a href="../../design/downloads/index.html">Downloads</a></li>
                <li><a href="../../design/videos/index.html">Videos</a></li>
              </ul>
            </li>
            <li class="develop">
              <ul>
                <li><a href="../../training/index.html"
                  zh-tw-lang="訓練課程"
                  zh-cn-lang="培训"
                  ru-lang="Курсы"
                  ko-lang="교육"
                  ja-lang="トレーニング"
                  es-lang="Capacitación"
                  >Training</a></li>
                <li><a href="../../guide/index.html"
                  zh-tw-lang="API 指南"
                  zh-cn-lang="API 指南"
                  ru-lang="Руководства по API"
                  ko-lang="API 가이드"
                  ja-lang="API ガイド"
                  es-lang="Guías de la API"
                  >API Guides</a></li>
                <li><a href="../../reference/packages.html"
                  zh-tw-lang="參考資源"
                  zh-cn-lang="参考"
                  ru-lang="Справочник"
                  ko-lang="참조문서"
                  ja-lang="リファレンス"
                  es-lang="Referencia"
                  >Reference</a></li>
                <li><a href="../../tools/index.html"
                  zh-tw-lang="相關工具"
                  zh-cn-lang="工具"
                  ru-lang="Инструменты"
                  ko-lang="도구"
                  ja-lang="ツール"
                  es-lang="Herramientas"
                  >Tools</a>
                  <ul><li><a href="../../sdk/index.html">Get the SDK</a></li></ul>
                </li>
                <li><a href="../../google/index.html">Google Services</a>
                </li>
                
              </ul>
            </li>
            <li class="distribute last">
              <ul>
                <li><a href="../../distribute/googleplay/index.html">Google Play</a></li>
                <li><a href="../../distribute/essentials/index.html">Essentials</a></li>
                <li><a href="../../distribute/users/index.html">Get Users</a></li>
                <li><a href="../../distribute/engage/index.html">Engage &amp; Retain</a></li>
                <li><a href="../../distribute/monetize/index.html">Monetize</a></li>
                <li><a href="../../distribute/tools/index.html">Tools &amp; Reference</a></li>
                <li><a href="../../distribute/stories/index.html">Developer Stories</a></li>
              </ul>
            </li>
          </ul>
        </div><!-- /Expanded quicknav -->
      </div><!-- end header-wrap.wrap -->
    </div><!-- end header -->

  
    <!-- Secondary x-nav -->
    <div id="nav-x">
        <div class="wrap">
            <ul class="nav-x col-9 develop" style="width:100%">
                <li class="training"><a href="../../training/index.html"
                  zh-tw-lang="訓練課程"
                  zh-cn-lang="培训"
                  ru-lang="Курсы"
                  ko-lang="교육"
                  ja-lang="トレーニング"
                  es-lang="Capacitación"
                  >Training</a></li>
                <li class="guide"><a href="../../guide/index.html"
                  zh-tw-lang="API 指南"
                  zh-cn-lang="API 指南"
                  ru-lang="Руководства по API"
                  ko-lang="API 가이드"
                  ja-lang="API ガイド"
                  es-lang="Guías de la API"
                  >API Guides</a></li>
                <li class="reference"><a href="../../reference/packages.html"
                  zh-tw-lang="參考資源"
                  zh-cn-lang="参考"
                  ru-lang="Справочник"
                  ko-lang="참조문서"
                  ja-lang="リファレンス"
                  es-lang="Referencia"
                  >Reference</a></li>
                <li class="tools"><a href="../../tools/index.html"
                  zh-tw-lang="相關工具"
                  zh-cn-lang="工具"
                  ru-lang="Инструменты"
                  ko-lang="도구"
                  ja-lang="ツール"
                  es-lang="Herramientas"
                  >Tools</a></li>
                <li class="google"><a href="../../google/index.html"
                  >Google Services</a>
                </li>
                
            </ul>
        </div>
    </div>
    <!-- /Sendondary x-nav -->

  

    <div id="searchResults" class="wrap" style="display:none;">
      <h2 id="searchTitle">Results</h2>
      <div id="leftSearchControl" class="search-control">Loading...</div>
    </div>
  </div> <!--end header-wrapper -->

  <div id="sticky-header">
    <div>
      <a class="logo" href="#top"></a>
      <a class="top" href="#top"></a>
      <ul class="breadcrumb">
        
        <li class="current">Analyzing Display and Performance</li>
      </ul>
    </div>
  </div>




  <div class="wrap clearfix" id="body-content">
    <div class="col-3" id="side-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
      <div id="devdoc-nav" class="scroll-pane">
<ul id="nav">

  <li class="nav-section">
    <div class="nav-section-header empty">
        <a href="../../tools/index.html"><span class="en">Developer Tools</span></a>
    </div>
  </li>

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../sdk/index.html"><span class="en">Download</span></a></div>
    <ul>
      <li><a href="../../sdk/installing/bundle.html">
          <span class="en">Setting Up the ADT Bundle</span></a></li>

      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../../sdk/installing/index.html"><span class="en">Setting Up
    an Existing IDE</span></a></div>
        <ul>
          <li><a href="../../sdk/installing/installing-adt.html">
              <span class="en">Installing the Eclipse Plugin</span></a></li>
        <li><a href="../../sdk/installing/adding-packages.html">
            <span class="en">Adding Platforms and Packages</span></a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
          <a href="../../sdk/installing/studio.html">Android Studio</a>
        </div>
        <ul>
          <li><a href="../../sdk/installing/migrate.html">
              Migrating from Eclipse</a></li>
          <li><a href="../../sdk/installing/studio-tips.html">
              Tips and Tricks</a></li>
          <li><a href="../../sdk/installing/studio-layout.html">
              Using the Layout Editor</a></li>
          <li><a href="../../sdk/installing/studio-build.html">
              Building Your Project with Gradle</a></li>
          <li><a href="../../sdk/installing/studio-debug.html">
              Debugging with Android Studio</a></li>
          </ul>
      </li>
      <li><a href="../../sdk/exploring.html">
          <span class="en">Exploring the SDK</span></a></li>
      <li><a href="../../tools/sdk/ndk/index.html">Download the NDK</a>
      </li>
    </ul>
  </li>

  <li class="nav-section">
    <div class="nav-section-header">
        <a href="../../tools/workflow/index.html"><span class="en">Workflow</span></a>
    </div>
    <ul>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../tools/devices/index.html"><span class="en">Setting Up Virtual Devices</span></a></div>
        <ul>
          <li><a href="../../tools/devices/managing-avds.html"><span class="en">With AVD Manager</span></a></li>
          <li><a href="../../tools/devices/managing-avds-cmdline.html"><span class="en">From the Command Line</span></a></li>
          <li><a href="../../tools/devices/emulator.html"><span class="en">Using the Emulator</span></a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../tools/device.html"><span class="en">Using Hardware Devices</span></a></div>
        <ul>
          <li><a href="../../tools/extras/oem-usb.html"><span
            class="en">USB Drivers</span></a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../tools/projects/index.html"><span class="en">Setting Up Projects</span></a></div>
        <ul>
          <li><a href="../../tools/projects/projects-eclipse.html"><span class="en">From Eclipse with ADT</span></a></li>
          <li><a href="../../tools/projects/projects-cmdline.html"><span class="en">From the Command Line</span></a></li>
          <li><a href="../../tools/projects/templates.html"><span class="en">Using Code Templates</span></a></li>
        </ul>
      </li>


      <li class="nav-section">
        <div class="nav-section-header"><a href="../../tools/building/index.html"><span class="en">Building and Running</span></a></div>
        <ul>
          <li><a href="../../tools/building/building-eclipse.html"><span class="en">From Eclipse with ADT</span></a></li>
          <li><a href="../../tools/building/building-cmdline.html"><span class="en">From the Command Line</span></a></li>
        </ul>
      </li>


  <li class="nav-section">
        <div class="nav-section-header"><a href="../../tools/testing/index.html">
            <span class="en">Testing</span>
          </a></div>
        <ul>
          <li>
            <a href="../../tools/testing/testing_android.html">
            <span class="en">Fundamentals</span></a>
          </li>
          <li><a href="../../tools/testing/testing_eclipse.html">
            <span class="en">From Eclipse</span></a>
          </li>
          <li><a href="../../tools/testing/testing_otheride.html">
            <span class="en">From Other IDEs</span></a>
          </li>
          <li>
            <a href="../../tools/testing/activity_testing.html">
            <span class="en">Activity Testing</span></a>
          </li>
          <li>
            <a href="../../tools/testing/service_testing.html">
            <span class="en">Service Testing</span></a>
          </li>
          <li>
            <a href="../../tools/testing/contentprovider_testing.html">
            <span class="en">Content Provider Testing</span></a>
          </li>
          <li>
            <a href="../../tools/testing/testing_accessibility.html">
            <span class="en">Accessibility Testing</span></a>
          </li>
           <li>
            <a href="../../tools/testing/testing_ui.html">
            <span class="en">UI Testing</span></a>
          </li>
          <li>
            <a href="../../tools/testing/what_to_test.html">
            <span class="en">What To Test</span></a>
          </li>
          <li>
            <a href="../../tools/testing/activity_test.html">
            <span class="en">Activity Testing Tutorial</span></a>
          </li>
        </ul>
  </li><!-- end of testing -->

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../tools/debugging/index.html"><span class="en">Debugging</span></a></div>
    <ul>
      <li><a href="../../tools/debugging/debugging-projects.html"><span class="en">From Eclipse with ADT</span></a></li>
      <li><a href="../../tools/debugging/debugging-projects-cmdline.html"><span class="en">From Other IDEs</span></a></li>
      <li><a href="../../tools/debugging/ddms.html"><span class="en">Using DDMS</span></a></li>
      <li><a href="../../tools/debugging/debugging-log.html"><span class="en">Reading and Writing Logs</span></a></li>
      <li><a href="../../tools/debugging/improving-w-lint.html"><span class="en">Improving Your Code with lint</span></a></li>
      <li><a href="../../tools/debugging/debugging-ui.html"><span class="en">Optimizing your UI</span></a></li>
      <li><a href="../../tools/debugging/debugging-tracing.html"><span class="en">Profiling with Traceview and dmtracedump</span></a></li>
      <li><a href="../../tools/debugging/systrace.html"><span class="en">Analyzing Display and Performance</span></a></li>
      <li><a href="../../tools/debugging/debugging-memory.html">Investigating Your RAM Usage</a></li>
      <li><a href="../../tools/debugging/debugging-devtools.html"><span class="en">Using the Dev Tools App</span></a></li>
    </ul>
  </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../tools/publishing/publishing_overview.html"><span class="en">Publishing</span></a></div>
        <ul>
          <li><a href="../../tools/publishing/preparing.html"><span class="en">Preparing for Release</span></a></li>
          <li><a href="../../tools/publishing/versioning.html"><span class="en">Versioning Your Apps</span></a></li>
          <li><a href="../../tools/publishing/app-signing.html"><span class="en">Signing Your Apps</span></a></li>
        </ul>
      </li>
    </ul>
  </li>

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../tools/support-library/index.html"><span
class="en">Support Library</span></a></div>
    <ul>
      <li><a href="../../tools/support-library/features.html">Features</a></li>
      <li><a href="../../tools/support-library/setup.html">Setup</a></li>
    </ul>
  </li>

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../tools/help/index.html"><span
class="en">Tools Help</span></a></div>
    <ul>
      <li><a href="../../tools/help/adb.html">adb</a></li>
      <li><a href="../../tools/help/adt.html">ADT</a></li>
      <li><a href="../../tools/help/android.html">android</a></li>
      <li><a href="../../tools/help/avd-manager.html">AVD Manager</a></li>
      <li><a href="../../tools/help/bmgr.html">bmgr</a>
      <li><a href="../../tools/help/monitor.html">Device Monitor</a></li>
      <li><a href="../../tools/help/dmtracedump.html">dmtracedump</a></li>
      <li><a href="../../tools/help/draw9patch.html">Draw 9-Patch</a></li>
      <li><a href="../../tools/help/emulator.html">Emulator</a></li>
      <li><a href="../../tools/help/etc1tool.html">etc1tool</a></li>
      <li><a href="../../tools/help/hierarchy-viewer.html">Hierarchy Viewer</a></li>
      <li><a href="../../tools/help/hprof-conv.html">hprof-conv</a></li>
      <li><a href="../../tools/help/jobb.html">jobb</a></li>
      <li><a href="../../tools/help/lint.html">lint</span></a></li>
      <li><a href="../../tools/help/logcat.html">logcat</a></li>
      <li><a href="../../tools/help/mksdcard.html">mksdcard</a></li>
      <li><a href="../../tools/help/monkey.html">monkey</a></li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../tools/help/monkeyrunner_concepts.html"><span class="en">monkeyrunner</span></a></div>
        <ul>
          <li><a href="../../tools/help/MonkeyDevice.html"><span
class="en">MonkeyDevice</span></a></li>
          <li><a href="../../tools/help/MonkeyImage.html"><span
class="en">MonkeyImage</span></a></li>
          <li><a href="../../tools/help/MonkeyRunner.html"><span
class="en">MonkeyRunner</span></a></li>
        </ul>
      </li>
       <li><a href="../../tools/help/proguard.html">ProGuard</a></li>
       <li><a href="../../tools/help/sdk-manager.html">SDK Manager</a></li>
       <li><a href="../../tools/help/systrace.html">Systrace</a></li>
       <li><a href="../../tools/help/gltracer.html">Tracer for OpenGL ES</a></li>
       <li><a href="../../tools/help/traceview.html">Traceview</a></li>
       <li class="nav-section">
          <div class="nav-section-header"><a href="../../tools/help/uiautomator/index.html"><span class="en">uiautomator</span></a></div>
          <ul>
             <li><a href="../../tools/help/uiautomator/Configurator.html"><span class="en">Configurator</span></a></li>
             <li><a href="../../tools/help/uiautomator/IAutomationSupport.html"><span class="en">IAutomationSupport</span></a></li>
             <li><a href="../../tools/help/uiautomator/UiAutomatorTestCase.html"><span class="en">UiAutomatorTestCase</span></a></li>
             <li><a href="../../tools/help/uiautomator/UiCollection.html"><span class="en">UiCollection</span></a></li>
             <li><a href="../../tools/help/uiautomator/UiDevice.html"><span class="en">UiDevice</span></a></li>
             <li><a href="../../tools/help/uiautomator/UiObject.html"><span class="en">UiObject</span></a></li>
             <li><a href="../../tools/help/uiautomator/UiObjectNotFoundException.html"><span class="en">UiObjectNotFoundException</span></a></li>
             <li><a href="../../tools/help/uiautomator/UiScrollable.html"><span class="en">UiScrollable</span></a></li>
             <li><a href="../../tools/help/uiautomator/UiSelector.html"><span class="en">UiSelector</span></a></li>
             <li><a href="../../tools/help/uiautomator/UiWatcher.html"><span class="en">UiWatcher</span></a></li>
          </ul>
       </li>
       <li><a href="../../tools/help/zipalign.html">zipalign</a></li>
    </ul>
  </li>

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../tools/revisions/index.html"><span class="en">Revisions</span></a></div>
    <ul>
      <li><a href="../../tools/sdk/tools-notes.html">
        <span class="en">SDK Tools</span>
      </a></li>
      <li><a href="../../tools/sdk/eclipse-adt.html">
        <span class="en">ADT Plugin</span>
      </a></li>
      <li><a href="../../tools/revisions/build-tools.html">
        <span class="en">Build Tools</span>
      </a></li>
      <li><a href="../../tools/revisions/platforms.html"><span
class="en">Platforms</span></a></li>
    </ul>
  </li>


  <li class="nav-section">
    <div class="nav-section-header">
    <a href="../../tools/adk/index.html">
      <span class="en">ADK</span></a>
    </div>
    <ul>
      <li><a href="../../tools/adk/adk2.html">ADK 2012 Guide</a></li>
      <li><a href="../../tools/adk/adk.html">ADK 2011 Guide</a></li>
    </ul>
  </li>

</ul><!-- nav -->

<script type="text/javascript">
<!--
    buildToggleLists();
    changeNavLang(getLangPref());
//-->
</script>

        
        
      </div>
    </div> <!-- end side-nav -->
    <script>
      $(document).ready(function() {
        scrollIntoView("devdoc-nav");
        });
    </script>




<div class="col-13" id="doc-col" >




  
    
      
        <h1 itemprop="name" >Analyzing Display and Performance</h1>
      
    
  


  
  <div id="jd-content">


    <div class="jd-descr" itemprop="articleBody">
    <div id="qv-wrapper">
  <div id="qv">
    <h2>In this document</h2>
    <ol>
      <li><a href="#overview">Overview</a>
      </li>
      <li><a href="#generate">Generating Traces</a>
        <ol>
          <li><a href="#limit-trace">Limiting trace data</a></li>
          <li><a href="#running-4.3">Tracing on Android 4.3 and higher</a>
          <li><a href="#running-4.2">Tracing on Android 4.2 and lower</a></li>
        </ol>
      </li>
      <li><a href="#app-trace">Tracing Application Code</a></li>
      <li><a href="#analysis">Analyzing Traces</a>
        <ol>
          <li><a href="#long-processes">Long running processes</a></li>
          <li><a href="#display-interupts">Interruptions in display execution</a></li>
        </ol>
      </li>
    </ol>
    <h2>See also</h2>
    <ol>
      <li><a href="../../tools/help/systrace.html">Systrace</a></li>
    </ol>
  </div>
</div>

<p>After building features, eliminating bugs, and cleaning up your code, you should spend some
  time looking at the performance of your application. The speed and smoothness with which your
  application draws pixels and performs operations has an significant impact on your users'
  experience.</p>

<p>Android applications operate within a shared resource environment, and the performance of
  your application can be impacted by how efficiently it interacts with those resources in
  the larger system. Applications also operate in a multithreaded environment, competing with other
  threaded processes for resources, which can cause performance problems that are hard to diagnose.
</p>

<p>The Systrace tool allows you to collect and review code execution data for your
  application and the Android system. You can use this data to diagnose execution problems and
  improve the performance of your application.</p>


<h2 id="overview">Overview</h2>

<p>Systrace helps you analyze how the execution of your application fits into the larger
  Android environment, letting you see system and applications process execution on a common
  timeline. The tool allows you to generate highly detailed, interactive reports from devices
  running Android 4.1 and higher, such as the report in figure 1.</p>

<img src="../../images/systrace/report.png" alt="Systrace example report" id="figure1" />
<p class="img-caption">
  <strong>Figure 1.</strong> An example Systrace report on 5 seconds of process execution
  for a running application and related Android system processes.
</p>


<h2 id="generate">Generating Traces</h2>

<p>In order to create a trace of your application, you must perform a few setup steps. First, you
  must have a device running Android 4.1 or higher. Set up the device for
  <a href="../../tools/device.html#setting-up">debugging</a>, connect it to your development
  system, and install your application. Some types of trace information, specifically disk activity
  and kernel work queues, require that you have root access to the device. However, most Systrace
  log data only requires that the device be enabled for developer debugging.</p>

<p>Systrace traces can be run either from a
  <a href="../../tools/help/systrace.html#options">command line</a> or from a
  <a href="../../tools/help/systrace.html#gui">graphical user interface</a>. This guide
  focuses on using the command line options.</p>


<h3 id="limit-trace">Limiting trace data</h3>

<p>The Systrace tool can generate a potentially huge amount of data from applications
  and system sources. To limit the amount of data the tool collects and make the data more relevant
  to your analysis, use the following options:</p>

<ul>
  <li>Limit the amount of time covered by the trace with the <code>-t, --time</code> option. The default
    length of a trace is 5 seconds.</li>
  <li>Limit the size of the data collected by the trace with the <code>-b, --buf-size</code> option.</li>
  <li>Specify what types of processes are traced. The types of processes that can be traced depends
    on the version of Android you are running:
    <ul>
      <li>Android 4.2 and lower devices: Use the <code>--set-tags</code> option and the <code>--disk</code>,
        <code>--cpu-freq</code>, <code>--cpu-idle</code>, <code>--cpu-load</code> options.</li>
      <li>Android 4.3 and higher devices: Use the <code>--list-categories</code> option to see what
        categories are available on your test device.</li>
    </ul>
   </li>
</ul>


<h3 id="running-4.3">Tracing on Android 4.3 and higher</h3>

<p>To run a trace on Android 4.3 and higher devices:</p>

<ol>
  <li>Make sure the device is connected through a USB cable and is
  <a href="../../tools/device.html#setting-up">enabled for debugging</a>.</li>
  <li>Run the trace with the options you want, for example:
<pre>
$ cd android-sdk/platform-tools/systrace
$ python systrace.py --time=10 -o mynewtrace.html sched gfx view wm
</pre>
  </li>
  <li>On the device, execute any user actions you want be included in the trace.</li>
</ol>

<p>For more information on the available options for running Systrace, see the
<a href="../../tools/help/systrace.html#options-4.3">Systrace</a> help page.</p>


<h3 id="running-4.2">Tracing on Android 4.2 and lower</h3>

<p>To use Systrace effectively with devices running Android 4.2 and lower,
  you must configure the types of processes you want to trace before running a trace.
  The tool can gather the following types of process information:</p>

<ul>
  <li>General system processes such as graphics, audio and input processes (selected using trace
    <a href="../../tools/help/systrace.html#tags">category tags</a>).</li>
  <li>Low level system information such as CPU, kernel and disk activity (selected using
    <a href="../../tools/help/systrace.html#options">options</a>).</li>
</ul>

<p>To set trace tags for Systrace using the command-line:</p>

<ol>
  <li>Use the <code>--set-tags</code> option:
<pre>
$ cd android-sdk/platform-tools/systrace
$ python systrace.py --set-tags=gfx,view,wm
</pre>
  </li>
  <li>Stop and restart the <code>adb</code> shell to enable tracing of these processes.
<pre>
$ adb shell stop
$ adb shell start
</pre></li>
</ol>

<p>To set trace tags for Systrace using the device user interface:</p>

<ol>
  <li>On the device connected for tracing, navigate to: <strong>Settings &gt;
      Developer options &gt; Monitoring &gt; Enable traces</strong>.</li>
  <li>Select the categories of processes to be traced and click <strong>OK</strong>.</li>
</ol>

<p class="note">
  <strong>Note:</strong> The <code>adb</code> shell does not have to be stopped and restarted when
  selecting trace tags using this method.
</p>

<p>After you have configured the category tags for your trace, you can start collecting
  information for analysis.</p>

<p>To run a trace using the current trace tag settings:</p>

<ol>
  <li>Make sure the device is connected through a USB cable and is
  <a href="../../tools/device.html#setting-up">enabled for debugging</a>.</li>
  <li>Run the trace with the low-level system trace options and limits you want, for example:
<pre>
$ python systrace.py --cpu-freq --cpu-load --time=10 -o mytracefile.html
</pre>
  </li>
  <li>On the device, execute any user actions you want be included in the trace.</li>
</ol>

<p>For more information on the available options for running Systrace, see the
<a href="../../tools/help/systrace.html#options-pre-4.3">Systrace</a> help page.</p>


<h2 id="app-trace">Tracing Application Code</h2>

<p>The Systrace tool can trace the execution of code within your application. In Android
4.3 (API level 18) and higher, you can use the methods of the <code><a href="../../reference/android/os/Trace.html">Trace</a></code> class to
add instrumentation to your application code and see the results in a Systrace report.</p>

<p>The following code example shows how to use the <code><a href="../../reference/android/os/Trace.html">Trace</a></code> class to track
execution of an application method, including two nested code blocks within that method.</p>

<pre>
public void ProcessPeople() {
    Trace.beginSection("ProcessPeople");
    try {
        Trace.beginSection("Processing Jane");
        try {
            // code for Jane task...
        } finally {
            Trace.endSection(); // ends "Processing Jane"
        }

        Trace.beginSection("Processing John");
        try {
            // code for John task...
        } finally {
            Trace.endSection(); // ends "Processing John"
        }
    } finally {
        Trace.endSection(); // ends "ProcessPeople"
    }
}
</pre>
<p class="note">
  <strong>Note:</strong> When you nest trace calls within each other, the
  <code><a href="../../reference/android/os/Trace.html#endSection()">endSection()</a></code> method ends the most recently called
  <code><a href="../../reference/android/os/Trace.html#beginSection(java.lang.String)">beginSection(String)</a></code> method. This means that a trace started within another
  trace cannot extend beyond the end of the enclosing trace, so make sure your beginning and
  ending method calls are properly matched to measure your applications processing.
</p>

<p class="note">
  <strong>Note:</strong> Traces must begin and end on the same thread. Do not call
  <code><a href="../../reference/android/os/Trace.html#beginSection(java.lang.String)">beginSection(String)</a></code> on one thread of execution and then attempt to end the
  trace with a call to <code><a href="../../reference/android/os/Trace.html#endSection()">endSection()</a></code> on another thread.
</p>

<p>When using application-level tracing with Systrace, you must specify the package name of your
application in the user interface or specify the <code>-a</code> or <code>--app=</code> options on the
command line. For more information, see the
<a href="../../tools/help/systrace.html">Systrace</a> help page.</p>

<!-- todo: add ndk coverage -->


<h2 id="analysis">Analyzing Traces</h2>

<p>After you have generated a trace using Systrace, it lists the location of the output
  file and you can open the report using a web browser.
  How you use the trace data depends on the performance issues you are investigating. However,
  this section provides some general instructions on how to analyze a trace.</p>

<p>The reports generated by Systrace are interactive, allowing you to zoom into and out of
  the process execution details. Use the <em>W</em> key to zoom in, the <em>S</em>
  key to zoom out, the <em>A</em> key to pan left and the <em>D</em> key to pan
  right. Select a task in timeline using your mouse to get more information about the task.
  For more information about the using the keyboard navigation shortcuts and navigation, see the
  <a href="../../tools/help/systrace.html#viewing-options">Systrace</a> reference
  documentation.</p>

<h3 id="long-processes">Long running processes</h3>

<p>A well-behaved application executes many small operations quickly and with a regular rhythm,
  with individual operations completing within few milliseconds, depending on the device
  and the processes being performed, as shown in figure 2:</p>

<img src="../../images/systrace/process-rhythm.png" alt="Systrace exerpt of app processing"
id="figure2" />
<p class="img-caption">
  <strong>Figure 2.</strong> Excerpt from a trace of a smoothly running application with a regular
  execution rhythm.
</p>

<p>The trace excerpt in figure 2 shows a well-behaved application with
  a regular process rhythm (1). The lower section of figure 2 shows a magnified section of
  the trace indicated by the dotted outline, which reveals some irregularity in the process
  execution. In particular, one of the wider task bars, indicated by (2), is taking slightly
  longer (14 milliseconds) than other, similar tasks on this thread, which are averaging between
  9 and 12 milliseconds to complete. This particular task execution length is likely not noticeable
  to a user, unless it impacts another process with specific timing, such as a screen update.</p>

<p>Long running processes show up as thicker than usual execution bars in a trace. These thicker
  bars can indicate a problem in your application performance. When they show up in your
  trace, zoom in on the process using the
  <a href="../../tools/help/systrace.html#viewing-options">keyboard navigation</a> shortcuts to
  identify the task causing the problem, and click on the task to get more information. You should
  also look at other processes running at the same time, looking for a thread in one process that is
  being blocked by another process.</p>


<h3 id="display-interupts">Interruptions in display execution</h3>

<p>The Systrace tool is particularly useful in analyzing application display slowness,
  or pauses in animations, because it shows you the execution of your application across multiple
  system processes. With display execution, drawing screen frames with a regular rhythm is essential
  for good performance. Having a regular rhythm for display ensures that animations and motion are
  smooth on screen. If an application drops out of this rhythm, the display can become jerky or slow
  from the users perspective.</p>

<p>If you are analyzing an application for this type of problem, examine the
  <strong>SurfaceFlinger</strong> process in the Systrace report where your application is
  also executing to look for places where it drops out of its regular rhythm.</p>

<img src="../../images/systrace/display-rhythm.png" alt="Systrace exerpt of display processing"
id="figure3" />
<p class="img-caption">
  <strong>Figure 3.</strong> Excerpt from a trace of an application showing interruptions in
  display processing.
</p>

<p>The trace excerpt in figure 3 shows an section of a trace that indicates an interruption in the
  device display. The section of the <strong>SurfaceFlinger</strong> process in top excerpt,
  indicated by (1), shows that display frames are being missed. These
  dropped frames are potentially causing the display to stutter or halt. Zooming into this problem
  area in the lower trace, shows that a memory operation (image buffer dequeuing and allocation) in
  the <strong>surfaceflinger</strong> secondary thread is taking a long time (2). This delay
  causes the application to miss the display update window, indicated by the dotted
  line. As the developer of this application, you should investigate other threads in your
  application that may also be trying to allocate memory at the same time or otherwise blocking
  memory allocation with another request or task.</p>

<p>Regular, rhythmic execution of the <strong>SurfaceFlinger</strong> process is essential to smooth
  display of screen content, particularly for animations and motion. Interruptions in the regular
  execution pattern of this thread is not always an indication of a display problem with your
  application. Further testing is required to determine if this is actually a performance problem
  from a user perspective. Being able to identify display execution patterns like the example above
  can help you detect display problems and build a smooth-running, high-performance application.
</p>

<p class="note">
  <strong>Note:</strong> When using Systrace to analyze display problems, make sure
  you activate the tracing tags for <strong>Graphics</strong> and <strong>Views</strong>.
</p>

<p>For more information on the command line options and keyboard controls for Systrace,
see the <a href="../../tools/help/systrace.html">Systrace</a> help page.</p>
    </div>

      <div class="content-footer layout-content-row"
                    itemscope itemtype="http://schema.org/SiteNavigationElement">
        <div class="layout-content-col col-9" style="padding-top:4px">
          
            <div class="g-plusone" data-size="medium"></div>
          
        </div>
        
        <div class="paging-links layout-content-col col-4">
          
        </div>
        
      </div>

      
      

  </div> <!-- end jd-content -->

<div id="footer" class="wrap" >
        

  <div id="copyright">
    
  Except as noted, this content is 
  licensed under <a href="http://creativecommons.org/licenses/by/2.5/">
  Creative Commons Attribution 2.5</a>. For details and 
  restrictions, see the <a href="../../license.html">Content 
  License</a>.
  </div>


  <div id="footerlinks">
    
  <p>
    <a href="../../about/index.html">About Android</a>&nbsp;&nbsp;|&nbsp;
    <a href="../../legal.html">Legal</a>&nbsp;&nbsp;|&nbsp;
    <a href="../../support.html">Support</a>
  </p>
  </div>

</div> <!-- end footer -->
</div><!-- end doc-content -->

<!-- Start of Tag -->
<script type="text/javascript">
var axel = Math.random() + "";
var a = axel * 10000000000000;
document.write('<iframe src="https://2507573.fls.doubleclick.net/activityi;src=2507573;type=other026;cat=googl348;ord=' + a + '?" width="1" height="1" frameborder="0" style="display:none"></iframe>');
</script>
<noscript>
<iframe src="https://2507573.fls.doubleclick.net/activityi;src=2507573;type=other026;cat=googl348;ord=1?" width="1" height="1" frameborder="0" style="display:none"></iframe>
</noscript>
<!-- End of Tag -->


</div> <!-- end body-content --> 





  <script src="https://developer.android.com/ytblogger_lists_unified.js" type="text/javascript"></script>
  <script src="../../jd_lists_unified.js" type="text/javascript"></script>
  <script src="../../jd_extras.js" type="text/javascript"></script>
  <script src="../../jd_collections.js" type="text/javascript"></script>
  <script src="../../jd_tag_helpers.js" type="text/javascript"></script>

</body>
</html>



